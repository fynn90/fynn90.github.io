<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="InversifyJS"/>




  <meta name="keywords" content="InversifyJS, IoC, Fynn's Blog" />










  <link rel="alternate" href="/atom.xml" title="Fynn's Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="https://fynn90.github.io/2021/02/18/InversifyJS/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  
  <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?607980a031d3edcefed502ce80e77ffb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script id="google_analytics">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-115728733-1', 'auto');
        ga('send', 'pageview');
  </script>


  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>





  <script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "jH321kB4p1r5FNrL8YBCwbrG-gzGzoHsz",
      appKey: "Q8vnaBtTzmVPbVX8tdzM7z7w"
    });
  </script>





    <title> InversifyJS - Fynn's Blog </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Fynn's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            é¦–é¡µ
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            å½’æ¡£
          
        </li>
      </a>
    
      <a href="/categories/">
        <li class="mobile-menu-item">
          
          
            åˆ†ç±»
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Fynn's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              é¦–é¡µ
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              å½’æ¡£
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            
            
              åˆ†ç±»
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          InversifyJS
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-02-18
        </span>
        
          <div class="post-category">
            
              <a href="/categories/è®¾è®¡æ¨¡å¼/">è®¾è®¡æ¨¡å¼</a>
            
              <a href="/categories/è®¾è®¡æ¨¡å¼/TypeScript/">TypeScript</a>
            
          </div>
        
        
        <div class="post-visits"
             data-url="/2021/02/18/InversifyJS/"
             data-title="InversifyJS">
            é˜…è¯»æ¬¡æ•°
          </div>
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å®‰è£…"><span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸€ä¸ªç®€å•ä¾‹å­-ğŸŒ°"><span class="toc-text">ä¸€ä¸ªç®€å•ä¾‹å­ ğŸŒ°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ ¸å¿ƒèƒ½åŠ›"><span class="toc-text">æ ¸å¿ƒèƒ½åŠ›</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å®¹å™¨æ¨¡å—"><span class="toc-text">å®¹å™¨æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³¨å…¥å·¥å‚"><span class="toc-text">æ³¨å…¥å·¥å‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¿€æ´»å¥æŸ„"><span class="toc-text">æ¿€æ´»å¥æŸ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ„é€ å™¨åç½®è£…é¥°å™¨"><span class="toc-text">æ„é€ å™¨åç½®è£…é¥°å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åç§°ç»‘å®š"><span class="toc-text">åç§°ç»‘å®š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸­é—´ä»¶"><span class="toc-text">ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ"><span class="toc-text">å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é—®é¢˜"><span class="toc-text">é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¾ªç¯ä¾èµ–"><span class="toc-text">å¾ªç¯ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç»§æ‰¿"><span class="toc-text">ç»§æ‰¿</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½¿ç”¨-unmanaged-è£…é¥°å™¨"><span class="toc-text">ä½¿ç”¨ @unmanaged è£…é¥°å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å±æ€§è®¾ç½®å™¨"><span class="toc-text">å±æ€§è®¾ç½®å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å±æ€§æ³¨å…¥"><span class="toc-text">å±æ€§æ³¨å…¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ³¨å…¥åˆ°å­ç±»"><span class="toc-text">æ³¨å…¥åˆ°å­ç±»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨"><span class="toc-text">ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æœ€ä½³å®è·µ"><span class="toc-text">æœ€ä½³å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç»„åˆé‡ç”¨åŸåˆ™"><span class="toc-text">ç»„åˆé‡ç”¨åŸåˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¾èµ–å€’ç½®åŸåˆ™"><span class="toc-text">ä¾èµ–å€’ç½®åŸåˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º"><span class="toc-text">é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹"><span class="toc-text">é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥"><span class="toc-text">é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Refer-To"><span class="toc-text">Refer To</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p><img src="https://img.imgdb.cn/item/60210c323ffa7d37b39eaaa8.jpg" alt=""></p>
<p><a href="https://inversify.io/" target="_blank" rel="noopener">InversifyJS</a> æ˜¯ä¸€ä¸ªè½»é‡çš„ (4KB) æ§åˆ¶åè½¬å®¹å™¨ (<a href="https://zh.wikipedia.org/wiki/%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC" target="_blank" rel="noopener">IoC</a>)ï¼Œå¯ç”¨äºç¼–å†™ TypeScript å’Œ JavaScript åº”ç”¨ã€‚ å®ƒä½¿ç”¨ç±»æ„é€ å‡½æ•°å»å®šä¹‰å’Œæ³¨å…¥å®ƒçš„ä¾èµ–ã€‚</p>
<p>å› ä¸º ES6 ä¹‹å JavaScript æ”¯æŒç”¨ Class æ–¹å¼ç”¨äº<a href="https://zh.wikipedia.org/wiki/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1" target="_blank" rel="noopener">OOP</a>ç¼–ç¨‹ï¼Œä½†è¦åšå¥½ OOP è®¾è®¡æ˜¯å¾ˆå›°éš¾çš„ï¼ŒInversifyJS å®ƒèƒ½å¸®åŠ© JavaScript å¼€å‘è€…ï¼Œå†™å‡ºå‡ºè‰²çš„é¢å‘å¯¹è±¡è®¾è®¡çš„ä»£ç ã€‚</p>
<p>InversifyJS çš„è®¾è®¡å“²å­¦ï¼š</p>
<ul>
<li>å…è®¸ JavaScript å¼€å‘äººå‘˜ç¼–å†™éµå¾ª <a href="https://zh.wikipedia.org/zh-sg/SOLID_(%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1" target="_blank" rel="noopener">SOLID</a>&gt;) åŸåˆ™çš„ä»£ç </li>
<li>ä¿ƒè¿›å¹¶é¼“åŠ±éµå®ˆæœ€ä½³çš„ OOP ç¼–ç¨‹å’Œ IoC å®è·µ</li>
<li>å°½å¯èƒ½å°‘çš„è¿è¡Œæ—¶å¼€é”€</li>
<li>æä¾›<a href="https://github.com/inversify/InversifyJS/blob/master/wiki/ecosystem.md" target="_blank" rel="noopener">è‰ºæœ¯ç¼–ç¨‹ä½“éªŒå’Œç”Ÿæ€</a></li>
</ul>
<a id="more"></a>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install inversify reflect-metadata --save</span><br></pre></td></tr></table></figure>
<p>InversifyJS ä¾èµ–äº TypeScript 2.0ã€‚éœ€è¦å¯¹<code>tsconfig.json</code>çš„<code>compilerOptions</code>è¿›è¡Œ<code>experimentalDecorators</code>,<code>emitDecoratorMetadata</code>,<code>type</code>å’Œ<code>lib</code>é…ç½®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"es5"</span>,</span><br><span class="line">    <span class="attr">"lib"</span>: [<span class="string">"es6"</span>, <span class="string">"dom"</span>],</span><br><span class="line">    <span class="attr">"types"</span>: [<span class="string">"reflect-metadata"</span>],</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line">    <span class="attr">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">    <span class="attr">"experimentalDecorators"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"emitDecoratorMetadata"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>inversifyjs éœ€è¦ç°ä»£ JavaScript å¼•æ“ï¼Œæ”¯æŒä»¥ä¸‹ç‰¹æ€§</p>
<ul>
<li><a href="https://rbuckton.github.io/reflect-metadata/" target="_blank" rel="noopener">Reflect metadata</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="noopener">Map</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">Promise</a> (Only required if using <a href="https://github.com/inversify/InversifyJS/blob/master/wiki/provider_injection.md" target="_blank" rel="noopener">provider injection</a>)</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">Proxy</a> (Only required if using <a href="https://github.com/inversify/InversifyJS/blob/master/wiki/activation_handler.md" target="_blank" rel="noopener">activation handlers</a>)</li>
</ul>
<p>å¦‚æœæ‚¨çš„  è¿è¡Œç¯å¢ƒä¸æ”¯æŒ  è¿™äº›  ç‰¹æ€§ï¼Œæ‚¨å¯èƒ½éœ€è¦å¯¼å…¥ <code>shim</code> æˆ– <code>polyfill</code></p>
<blockquote>
<p>ï¼šè­¦ç¤ºï¼š <strong><code>reflect-metadata</code> <code>polyfill</code> åº”è¯¥åœ¨æ‚¨æ•´ä¸ªåº”ç”¨ä¸­åªå¯¼å…¥ä¸€æ¬¡</strong> å› ä¸º <code>Reflect</code> å¯¹è±¡  éœ€è¦æˆä¸ºä¸€ä¸ªå…¨å±€çš„å•ä¾‹ã€‚ æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨<a href="https://github.com/inversify/InversifyJS/issues/262#issuecomment-227593844" target="_blank" rel="noopener">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p>
</blockquote>
<p>æŸ¥çœ‹ç»´åŸºä¸­çš„<a href="https://github.com/inversify/InversifyJS/blob/master/wiki/environment.md" target="_blank" rel="noopener">å¼€å‘ç¯å¢ƒ <code>polyfills</code></a> , è¿˜å¯ä»¥ä»<a href="https://github.com/inversify/inversify-basic-example" target="_blank" rel="noopener">åŸºæœ¬ç¤ºä¾‹</a>ä¸­å»å­¦ä¹ .</p>
<h2 id="ä¸€ä¸ªç®€å•ä¾‹å­-ğŸŒ°"><a href="#ä¸€ä¸ªç®€å•ä¾‹å­-ğŸŒ°" class="headerlink" title="ä¸€ä¸ªç®€å•ä¾‹å­ ğŸŒ°"></a><a href="https://github.com/fynn90/InversifyJS-demo/tree/main/demo1" target="_blank" rel="noopener">ä¸€ä¸ªç®€å•ä¾‹å­ ğŸŒ°</a></h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entites.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, inject &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Weapon, ThrowableWeapon, Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> hit() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"cut!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">throw</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hit!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Weapon;</span><br><span class="line">  <span class="keyword">private</span> _shuriken: ThrowableWeapon;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Weapon) katana: Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.ThrowableWeapon) shuriken: ThrowableWeapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">    <span class="keyword">this</span>._shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">  fight(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">  sneak(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._shuriken.throw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Ninja, Katana, Shuriken &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interface.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Warrior &#123;</span><br><span class="line">  fight(): <span class="built_in">string</span>;</span><br><span class="line">  sneak(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  hit(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">throw</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">const</span> TYPES = &#123;</span><br><span class="line">  Warrior: Symbol.for(<span class="string">"Warrior"</span>),</span><br><span class="line">  Weapon: Symbol.for(<span class="string">"Weapon"</span>),</span><br><span class="line">  ThrowableWeapon: Symbol.for(<span class="string">"ThrowableWeapon"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; TYPES &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior, Weapon, ThrowableWeapon &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Ninja, Katana, Shuriken &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myContainer = <span class="keyword">new</span> Container();</span><br><span class="line">myContainer.bind&lt;Warrior&gt;(TYPES.Warrior).to(Ninja);</span><br><span class="line">myContainer.bind&lt;Weapon&gt;(TYPES.Weapon).to(Katana);</span><br><span class="line">myContainer.bind&lt;ThrowableWeapon&gt;(TYPES.ThrowableWeapon).to(Shuriken);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; myContainer &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; myContainer &#125; <span class="keyword">from</span> <span class="string">"./inversify.config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ninja = myContainer.get&lt;Warrior&gt;(TYPES.Warrior);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ninja.fight());</span><br></pre></td></tr></table></figure>
<ul>
<li><code>injectable</code> - å£°æ˜ class å¯ä»¥ç”¨æ¥æ³¨å…¥</li>
<li><code>inject</code> - ç”¨æ¥å£°æ˜æ¥éœ€è¦æ³¨å…¥çš„ å¯¹è±¡</li>
</ul>
<p><strong>inversify.config.ts</strong> è¯´æ˜ å£°æ˜å’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ inversifyJS ç”¨æ¥ç®¡ç†å£°æ˜å’Œå¯¹è±¡ä¹‹é—´å…³ç³»çš„ã€‚</p>
<p><code>myContainer.get&lt;Warrior&gt;(TYPES.Warrior)</code> è·å–éœ€è¦ä½¿ç”¨çš„å¯¹è±¡</p>
<h2 id="æ ¸å¿ƒèƒ½åŠ›"><a href="#æ ¸å¿ƒèƒ½åŠ›" class="headerlink" title="æ ¸å¿ƒèƒ½åŠ›"></a>æ ¸å¿ƒèƒ½åŠ›</h2><h3 id="å®¹å™¨æ¨¡å—"><a href="#å®¹å™¨æ¨¡å—" class="headerlink" title="å®¹å™¨æ¨¡å—"></a><a href="https://github.com/fynn90/InversifyJS-demo/tree/main/demo3" target="_blank" rel="noopener">å®¹å™¨æ¨¡å—</a></h3><p>å½“åº”ç”¨é¡¹ç›®å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œå€ŸåŠ©å®¹å™¨æ¨¡å—å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†åº”ç”¨ä¸­å¤æ‚çš„ç»‘å®šå…³ç³»</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entities.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, inject &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Weapon, ThrowableWeapon, Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> hit() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"cut!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">throw</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hit!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Weapon;</span><br><span class="line">  <span class="keyword">private</span> _shuriken: ThrowableWeapon;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Weapon) katana: Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.ThrowableWeapon) shuriken: ThrowableWeapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">    <span class="keyword">this</span>._shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">  fight(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">  sneak(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._shuriken.throw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Ninja, Katana, Shuriken &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interfaces.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Warrior &#123;</span><br><span class="line">  fight(): <span class="built_in">string</span>;</span><br><span class="line">  sneak(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  hit(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">throw</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container, ContainerModule, interfaces &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior, Weapon, ThrowableWeapon &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Ninja, Katana, Shuriken &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¹å™¨å¯ä»¥ç”¨æ¥ç»‘å®š classç›´æ¥çš„å…³ç³»</span></span><br><span class="line"><span class="keyword">let</span> warriorModule = <span class="keyword">new</span> ContainerModule(</span><br><span class="line">  (bind: interfaces.Bind, unbind: interfaces.Unbind) =&gt; &#123;</span><br><span class="line">    bind&lt;Warrior&gt;(TYPES.Warrior).to(Ninja);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> weaponModule = <span class="keyword">new</span> ContainerModule(</span><br><span class="line">  (bind: interfaces.Bind, unbind: interfaces.Unbind) =&gt; &#123;</span><br><span class="line">    bind&lt;Weapon&gt;(TYPES.Weapon).to(Katana);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> throwableWeaponModule = <span class="keyword">new</span> ContainerModule(</span><br><span class="line">  (bind: interfaces.Bind, unbind: interfaces.Unbind) =&gt; &#123;</span><br><span class="line">    bind&lt;ThrowableWeapon&gt;(TYPES.ThrowableWeapon).to(Shuriken);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> container = <span class="keyword">new</span> Container();</span><br><span class="line"></span><br><span class="line">container.load(warriorModule, weaponModule, throwableWeaponModule);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; warriorModule, weaponModule, throwableWeaponModule &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">const</span> TYPES = &#123;</span><br><span class="line">  Warrior: Symbol.for(<span class="string">"Warrior"</span>),</span><br><span class="line">  Weapon: Symbol.for(<span class="string">"Weapon"</span>),</span><br><span class="line">  ThrowableWeapon: Symbol.for(<span class="string">"ThrowableWeapon"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; TYPES &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  warriorModule,</span><br><span class="line">  weaponModule,</span><br><span class="line">  throwableWeaponModule,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"./inversify.config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> container = <span class="keyword">new</span> Container();</span><br><span class="line"></span><br><span class="line">container.load(warriorModule, weaponModule, throwableWeaponModule);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ninja = container.get&lt;Warrior&gt;(TYPES.Warrior);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ninja.fight());</span><br></pre></td></tr></table></figure>
<h3 id="æ³¨å…¥å·¥å‚"><a href="#æ³¨å…¥å·¥å‚" class="headerlink" title="æ³¨å…¥å·¥å‚"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/factory_injection.md" target="_blank" rel="noopener">æ³¨å…¥å·¥å‚</a></h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entities.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, inject &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Weapon, ThrowableWeapon, Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> hit() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"cut!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">throw</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hit!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Weapon;</span><br><span class="line">  <span class="keyword">private</span> _shuriken: ThrowableWeapon;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="comment">// ç»‘å®šä¸€ä¸ªå·¥å‚å‡½æ•°</span></span></span><br><span class="line">    @inject(TYPES.Weapon) katana: (n: any) =&gt; Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.ThrowableWeapon) shuriken: ThrowableWeapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana(<span class="number">1</span>); <span class="comment">// å¯ä»¥å‘å·¥å‚å‡½æ•°ä¼ é€’å‚æ•°</span></span><br><span class="line">    <span class="keyword">this</span>._shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">  fight(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">  sneak(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._shuriken.throw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Ninja, Katana, Shuriken &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interfaces.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Warrior &#123;</span><br><span class="line">  fight(): <span class="built_in">string</span>;</span><br><span class="line">  sneak(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  hit(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">throw</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">const</span> TYPES = &#123;</span><br><span class="line">  Warrior: Symbol.for(<span class="string">"Warrior"</span>),</span><br><span class="line">  Weapon: Symbol.for(<span class="string">"Weapon"</span>),</span><br><span class="line">  ThrowableWeapon: Symbol.for(<span class="string">"ThrowableWeapon"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; TYPES &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container, interfaces &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior, Weapon, ThrowableWeapon &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Ninja, Katana, Shuriken &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myContainer = <span class="keyword">new</span> Container();</span><br><span class="line">myContainer.bind&lt;Warrior&gt;(TYPES.Warrior).to(Ninja);</span><br><span class="line">myContainer.bind&lt;Weapon&gt;(<span class="string">"TYPES.Weapon"</span>).to(Katana);</span><br><span class="line"><span class="comment">// ç»‘å®šå·¥å‚å‡½æ•°</span></span><br><span class="line">myContainer</span><br><span class="line">  .bind&lt;interfaces.Factory&lt;Weapon&gt;&gt;(TYPES.Weapon)</span><br><span class="line">  .toFactory&lt;Weapon&gt;<span class="function">(<span class="params">(<span class="params">context: interfaces.Context</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">return</span> (<span class="params">s</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="comment">// æ¥æ”¶å‚æ•°</span></span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="built_in">console</span>.log(<span class="params">s</span>);</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="keyword">return</span> context.container.<span class="keyword">get</span>&lt;Weapon&gt;(<span class="params">"TYPES.Weapon"</span>);</span></span></span><br><span class="line"><span class="function"><span class="params">    &#125;;</span></span></span><br><span class="line"><span class="function"><span class="params">  &#125;</span>);</span></span><br><span class="line"><span class="function"><span class="params">myContainer</span>.<span class="params">bind</span>&lt;<span class="params">ThrowableWeapon</span>&gt;(<span class="params">TYPES.ThrowableWeapon</span>).<span class="params">to</span>(<span class="params">Shuriken</span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="params">export</span> &#123; <span class="params">myContainer</span> &#125;;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="params">index</span>.<span class="params">ts</span></span></span><br><span class="line"><span class="function"><span class="params">import</span> "<span class="params">reflect</span>-<span class="params">metadata</span>";</span></span><br><span class="line"><span class="function"><span class="params">import</span> &#123; <span class="params">Warrior</span> &#125; <span class="params">from</span> "./<span class="params">interfaces</span>";</span></span><br><span class="line"><span class="function"><span class="params">import</span> &#123; <span class="params">myContainer</span> &#125; <span class="params">from</span> "./<span class="params">inversify</span>.<span class="params">config</span>";</span></span><br><span class="line"><span class="function"><span class="params">import</span> &#123; <span class="params">TYPES</span> &#125; <span class="params">from</span> "./<span class="params">types</span>";</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="params">const</span> <span class="params">ninja</span> = <span class="params">myContainer</span>.<span class="params">get</span>&lt;<span class="params">Warrior</span>&gt;(<span class="params">TYPES.Warrior</span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="params">console</span>.<span class="params">log</span>(<span class="params">ninja.fight(<span class="params"></span>)</span>);</span></span><br><span class="line"><span class="function">// 1</span></span><br><span class="line"><span class="function">// <span class="params">cut</span>!</span></span><br></pre></td></tr></table></figure>
<h3 id="æ¿€æ´»å¥æŸ„"><a href="#æ¿€æ´»å¥æŸ„" class="headerlink" title="æ¿€æ´»å¥æŸ„"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/activation_handler.md" target="_blank" rel="noopener">æ¿€æ´»å¥æŸ„</a></h3><p>ç»™ä¸€ä¸ªç±»å‹æ·»åŠ ä¸€ä¸ªæ¿€æ´»å¥æŸ„æ˜¯å¯èƒ½çš„ã€‚æ¿€æ´»å¥æŸ„åœ¨ä¾èµ–è¢«æ‰¾åˆ°åã€ä½†æ˜¯è¿˜æ²¡æœ‰è¢«æ·»åŠ åˆ°ç¼“å­˜ï¼ˆå¦‚æœæ˜¯å•ä¾‹çš„è¯ï¼‰å¹¶æ³¨å…¥ä¹‹å‰è¢«è°ƒç”¨ã€‚ è¿™éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥è®©æˆ‘ä»¬çš„ä¾èµ–ä¸å¿…å…³æ³¨æ¨ªåˆ‡é¢ï¼ˆæ¯”å¦‚ç¼“å­˜ã€æ—¥å¿—ç­‰ï¼‰çš„å…·ä½“å®ç°ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entities.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, inject &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Weapon, ThrowableWeapon, Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> hit() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"cut!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">throw</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hit!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Weapon;</span><br><span class="line">  <span class="keyword">private</span> _shuriken: ThrowableWeapon;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Weapon) katana: Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.ThrowableWeapon) shuriken: ThrowableWeapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">    <span class="keyword">this</span>._shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">  fight(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">  sneak(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._shuriken.throw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Ninja, Katana, Shuriken &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interfaces.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Warrior &#123;</span><br><span class="line">  fight(): <span class="built_in">string</span>;</span><br><span class="line">  sneak(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  hit(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">throw</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container, interfaces &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior, Weapon, ThrowableWeapon &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Ninja, Katana, Shuriken &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myContainer = <span class="keyword">new</span> Container();</span><br><span class="line">myContainer.bind&lt;Warrior&gt;(TYPES.Warrior).to(Ninja);</span><br><span class="line"><span class="comment">// ç»™ä¸€ä¸ªç±»å‹æ·»åŠ ä¸€ä¸ªæ¿€æ´»å¥æŸ„æ˜¯å¯èƒ½çš„ã€‚æ¿€æ´»å¥æŸ„åœ¨ä¾èµ–è¢«æ‰¾åˆ°åã€ä½†æ˜¯è¿˜æ²¡æœ‰è¢«æ·»åŠ åˆ°ç¼“å­˜ï¼ˆå¦‚æœæ˜¯å•ä¾‹çš„è¯ï¼‰å¹¶æ³¨å…¥ä¹‹å‰è¢«è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">// æ„Ÿè§‰ä¸å¦‚ç›´æ¥ å†™ä¸ª AOPè£…é¥°å™¨æ¥çš„æ–¹ä¾¿</span></span><br><span class="line">myContainer</span><br><span class="line">  .bind&lt;Weapon&gt;(TYPES.Weapon)</span><br><span class="line">  .to(Katana)</span><br><span class="line">  .onActivation(<span class="function">(<span class="params">context: interfaces.Context, _katana</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> handle = &#123;</span><br><span class="line">      apply(target: <span class="built_in">any</span>, thisArgument: <span class="built_in">any</span>, argumentsList: <span class="built_in">any</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Starting: <span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = target.apply(thisArgument, argumentsList);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Finished:<span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    _katana.hit = <span class="keyword">new</span> Proxy(_katana.hit, handle);</span><br><span class="line">    <span class="keyword">return</span> _katana;</span><br><span class="line">  &#125;);</span><br><span class="line">myContainer.bind&lt;ThrowableWeapon&gt;(TYPES.ThrowableWeapon).to(Shuriken);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; myContainer &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">const</span> TYPES = &#123;</span><br><span class="line">  Warrior: Symbol.for(<span class="string">"Warrior"</span>),</span><br><span class="line">  Weapon: Symbol.for(<span class="string">"Weapon"</span>),</span><br><span class="line">  ThrowableWeapon: Symbol.for(<span class="string">"ThrowableWeapon"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; TYPES &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; myContainer &#125; <span class="keyword">from</span> <span class="string">"./inversify.config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ninja = myContainer.get&lt;Warrior&gt;(TYPES.Warrior);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ninja.fight());</span><br></pre></td></tr></table></figure>
<p>è‡ªå·±å†™ä¸ª TS è£…é¥°å™¨ æ„Ÿè§‰æ¯”ç”¨æ¿€æ´»å¥æŸ„æ›´æ–¹ä¾¿ã€‚</p>
<h3 id="æ„é€ å™¨åç½®è£…é¥°å™¨"><a href="#æ„é€ å™¨åç½®è£…é¥°å™¨" class="headerlink" title="æ„é€ å™¨åç½®è£…é¥°å™¨"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/post_construct.md" target="_blank" rel="noopener">æ„é€ å™¨åç½®è£…é¥°å™¨</a></h3><p>å¯ä»¥æ·»åŠ ä¸€ä¸ª <strong>@postContruct</strong> è£…é¥°å™¨åˆ°ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ã€‚è¿™ä¸ªè£…é¥°å™¨å°†åœ¨ä¸€ä¸ªå¯¹è±¡è¢«ç¤ºä¾‹åŒ–ä¹‹åï¼Œä»¥åŠåœ¨æ‰€æœ‰æ¿€æ´»å¥æŸ„ä¹‹å‰è¿è¡Œã€‚ å½“æ„é€ å™¨å·²ç»è¢«è°ƒç”¨ä½†æ˜¯ç»„ä»¶è¿˜æ²¡æœ‰åˆå§‹åŒ–æˆ–è€…ä½ æƒ³åœ¨æ„é€ å™¨è¢«è°ƒç”¨åæ‰§è¡Œä¸€ä¸ªåˆå§‹åŒ–é€»è¾‘æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entities.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, postConstruct &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IKatana &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> IKatana &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Katana is born!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> use() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Used Katana!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * @postConstruct è£…é¥°å™¨åˆ°ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">   * è¿™ä¸ªè£…é¥°å™¨å°†åœ¨ä¸€ä¸ªå¯¹è±¡è¢«ç¤ºä¾‹åŒ–ä¹‹åï¼Œ</span></span><br><span class="line"><span class="comment">   * ä»¥åŠåœ¨æ‰€æœ‰æ¿€æ´»å¥æŸ„ä¹‹å‰è¿è¡Œã€‚</span></span><br><span class="line"><span class="comment">   * å½“æ„é€ å™¨å·²ç»è¢«è°ƒç”¨ä½†æ˜¯ç»„ä»¶è¿˜æ²¡æœ‰åˆå§‹åŒ–æˆ–è€…ä½ æƒ³åœ¨æ„é€ å™¨è¢«è°ƒç”¨åæ‰§è¡Œä¸€ä¸ªåˆå§‹åŒ–é€»è¾‘æ—¶éå¸¸æœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@postConstruct</span>()</span><br><span class="line">  <span class="keyword">public</span> testMethod() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"testMethod"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Katana &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Katana &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; IKatana &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyContainer = <span class="keyword">new</span> Container();</span><br><span class="line">MyContainer.bind&lt;IKatana&gt;(<span class="string">"Katana"</span>).to(Katana);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; MyContainer &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> IKatana &#123;</span><br><span class="line">  use: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; myContainer &#125; <span class="keyword">from</span> <span class="string">"./inversify.config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ninja = myContainer.get&lt;Warrior&gt;(TYPES.Warrior);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ninja.fight());</span><br></pre></td></tr></table></figure>
<h3 id="åç§°ç»‘å®š"><a href="#åç§°ç»‘å®š" class="headerlink" title="åç§°ç»‘å®š"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/named_bindings.md" target="_blank" rel="noopener">åç§°ç»‘å®š</a></h3><p>å½“æœ‰ä¸€ä¸ªæŠ½è±¡è¢«ç»‘å®šåˆ°å¤šä¸ªå…·ä½“å®ç°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>@name</code>æ¥åŒºåˆ†åŒä¸€ä¸ªæŠ½è±¡çš„ä¸åŒå…·ä½“å®ç°ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Weapon &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> Weapon &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Ninja &#123;</span><br><span class="line">  katana: Weapon;</span><br><span class="line">  shuriken: Weapon;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Ninja &#123;</span><br><span class="line">  <span class="keyword">public</span> katana: Weapon;</span><br><span class="line">  <span class="keyword">public</span> shuriken: Weapon;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject("Weapon") @named("strong") katana: Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(<span class="string">"Weapon"</span>) <span class="meta">@named</span>(<span class="string">"weak"</span>) shuriken: Weapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>.katana = katana;</span><br><span class="line">    <span class="keyword">this</span>.shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">container.bind&lt;Ninja&gt;(<span class="string">"Ninja"</span>).to(Ninja);</span><br><span class="line">container.bind&lt;Weapon&gt;(<span class="string">"Weapon"</span>).to(Katana).whenTargetNamed(<span class="string">"strong"</span>);</span><br><span class="line">container.bind&lt;Weapon&gt;(<span class="string">"Weapon"</span>).to(Shuriken).whenTargetNamed(<span class="string">"weak"</span>);</span><br></pre></td></tr></table></figure>
<p>InversifyJS è¿˜æä¾›äº†<a href="https://github.com/inversify/InversifyJS/blob/master/wiki/tagged_bindings.md" target="_blank" rel="noopener">æ ‡ç­¾ç»‘å®š</a>ã€<a href="https://github.com/inversify/InversifyJS/blob/master/wiki/contextual_bindings.md" target="_blank" rel="noopener">ä¸Šä¸‹æ–‡ç»‘å®š</a>ã€<a href="https://github.com/inversify/InversifyJS/blob/master/wiki/default_targets.md" target="_blank" rel="noopener">é»˜è®¤ç»‘å®š</a>ç”¨æ¥å¤„ç†ä¸€ä¸ªæŠ½è±¡ä¼šæœ‰å¤šä¸ªå…·ä½“å®ç°çš„æƒ…å†µã€‚</p>
<p>ç”¨äºç»‘å®šçš„ InversifyJS æµåˆ©è¯­æ³•åŒ…æ‹¬ä¸€äº›å·²ç»å®ç°çš„é€šç”¨ä¸Šä¸‹æ–‡çº¦æŸï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> BindingWhenSyntax&lt;T&gt; &#123;</span><br><span class="line">  when(</span><br><span class="line">    constraint: <span class="function">(<span class="params">request: interfaces.Request</span>) =&gt;</span> <span class="built_in">boolean</span></span><br><span class="line">  ): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenTargetNamed(name: <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenTargetTagged(tag: <span class="built_in">string</span>, value: <span class="built_in">any</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenInjectedInto(parent: <span class="built_in">Function</span> | <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenParentNamed(name: <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenParentTagged(tag: <span class="built_in">string</span>, value: <span class="built_in">any</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenAnyAncestorIs(ancestor: <span class="built_in">Function</span> | <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenNoAncestorIs(ancestor: <span class="built_in">Function</span> | <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenAnyAncestorNamed(name: <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenAnyAncestorTagged(tag: <span class="built_in">string</span>, value: <span class="built_in">any</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenNoAncestorNamed(name: <span class="built_in">string</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenNoAncestorTagged(tag: <span class="built_in">string</span>, value: <span class="built_in">any</span>): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenAnyAncestorMatches(</span><br><span class="line">    constraint: <span class="function">(<span class="params">request: interfaces.Request</span>) =&gt;</span> <span class="built_in">boolean</span></span><br><span class="line">  ): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">  whenNoAncestorMatches(</span><br><span class="line">    constraint: <span class="function">(<span class="params">request: interfaces.Request</span>) =&gt;</span> <span class="built_in">boolean</span></span><br><span class="line">  ): interfaces.BindingOnSyntax&lt;T&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/middleware.md" target="_blank" rel="noopener">ä¸­é—´ä»¶</a></h3><p>InversifyJS åœ¨è§£å†³ä¾èµ–å‰æ‰§è¡Œ 3 ä¸ªå¼ºåˆ¶æ“ä½œï¼š</p>
<ul>
<li>æ ‡è®°</li>
<li>è®¡åˆ’</li>
<li>è§£å†³</li>
</ul>
<p>æŸäº›æƒ…å†µä¸‹ä¼šæœ‰é¢å¤–æ“ä½œï¼š</p>
<ul>
<li>æ¿€æ´»</li>
<li>ä¸­é—´ä»¶</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬é…ç½®äº†ä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå®ƒä¼šåœ¨è®¡åˆ’é˜¶æ®µã€è§£å†³é˜¶æ®µä»¥åŠæ¿€æ´»é˜¶æ®µä¹‹å‰æˆ–è€…ä¹‹åçš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œã€‚</p>
<p>ä¸­é—´ä»¶å¯è¢«ç”¨æ¥å®ç°å¼ºå¤§çš„å¼€å‘å·¥å…·ã€‚è¿™äº›å·¥å…·å¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®šä½é—®é¢˜ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entities.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; injectable, inject &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Weapon, ThrowableWeapon, Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> hit() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"cut!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Shuriken <span class="keyword">implements</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">throw</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hit!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja <span class="keyword">implements</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Weapon;</span><br><span class="line">  <span class="keyword">private</span> _shuriken: ThrowableWeapon;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Weapon) katana: Weapon,</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.ThrowableWeapon) shuriken: ThrowableWeapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">    <span class="keyword">this</span>._shuriken = shuriken;</span><br><span class="line">  &#125;</span><br><span class="line">  fight(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">  sneak(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._shuriken.throw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; Ninja, Katana, Shuriken &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interface.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Warrior &#123;</span><br><span class="line">  fight(): <span class="built_in">string</span>;</span><br><span class="line">  sneak(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  hit(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ThrowableWeapon &#123;</span><br><span class="line">  <span class="keyword">throw</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// inversify.config.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Container, interfaces &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior, Weapon, ThrowableWeapon &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Ninja, Katana, Shuriken &#125; <span class="keyword">from</span> <span class="string">"./entities"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logger</span>(<span class="params">planAndResolve: interfaces.Next</span>): <span class="title">interfaces</span>.<span class="title">Next</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">args: interfaces.NextArgs</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="keyword">let</span> result = planAndResolve(args);</span><br><span class="line">    <span class="keyword">let</span> end = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Woooo <span class="subst">$&#123;end - start&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myContainer = <span class="keyword">new</span> Container();</span><br><span class="line">myContainer.bind&lt;Warrior&gt;(TYPES.Warrior).to(Ninja);</span><br><span class="line">myContainer.bind&lt;Weapon&gt;(TYPES.Weapon).to(Katana);</span><br><span class="line">myContainer.bind&lt;ThrowableWeapon&gt;(TYPES.ThrowableWeapon).to(Shuriken);</span><br><span class="line">myContainer.applyMiddleware(logger);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; myContainer &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">const</span> TYPES = &#123;</span><br><span class="line">  Warrior: Symbol.for(<span class="string">"Warrior"</span>),</span><br><span class="line">  Weapon: Symbol.for(<span class="string">"Weapon"</span>),</span><br><span class="line">  ThrowableWeapon: Symbol.for(<span class="string">"ThrowableWeapon"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; TYPES &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"reflect-metadata"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Warrior &#125; <span class="keyword">from</span> <span class="string">"./interfaces"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; myContainer &#125; <span class="keyword">from</span> <span class="string">"./inversify.config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TYPES &#125; <span class="keyword">from</span> <span class="string">"./types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ninja = myContainer.get&lt;Warrior&gt;(TYPES.Warrior);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ninja.fight());</span><br></pre></td></tr></table></figure>
<h3 id="å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ"><a href="#å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ" class="headerlink" title="å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/hierarchical_di.md" target="_blank" rel="noopener">å±‚æ¬¡åŒ–çš„ä¾èµ–å€’ç½®ç³»ç»Ÿ</a></h3><p>åœ¨å±‚æ¬¡åŒ–ä¾èµ–å€’ç½®ç³»ç»Ÿä¸­ï¼Œå®¹å™¨å¯ä»¥æœ‰çˆ¶å®¹å™¨ï¼Œå¹¶ä¸”ä¸€ä¸ªåº”ç”¨ä¸­å¯ä»¥æœ‰å¤šä¸ªå®¹å™¨ã€‚è¿™äº›å®¹å™¨å½¢æˆäº†å±‚æ¬¡åŒ–çš„ç»“æ„ã€‚</p>
<p>å½“ä¸€ä¸ªå¤„äºå±‚æ¬¡ç»“æ„ä¸­æœ€åº•å±‚çš„å®¹å™¨è¯·æ±‚ä¸€ä¸ªä¾èµ–é¡¹æ—¶ï¼Œå®¹å™¨å°è¯•åœ¨å…¶è‡ªèº«å†…éƒ¨çš„ç»‘å®šä¸­æŸ¥æ‰¾ã€‚å¦‚æœç¼ºå°‘ç›¸å…³ç»‘å®šï¼Œ<strong>å®ƒå‘ä¸Šä¼ é€’è¯·æ±‚åˆ°çˆ¶å®¹å™¨</strong>ã€‚è‹¥çˆ¶å®¹å™¨æŸ¥æ‰¾ä¸åˆ°ç›¸å…³ç»‘å®šåˆ™å†æ¬¡å‘ä¸Šä¼ é€’è¯·æ±‚ã€‚è¯·æ±‚è¢«å‘ä¸Šå†’æ³¡ä¼ é€’ç›´åˆ°æœ‰ä¸ªå®¹å™¨èƒ½å¤Ÿå¤„ç†è¿™ä¸ªè¯·æ±‚ä¸ºæ­¢æˆ–è€…è´¯ç©¿æ•´ä¸ªç¥–å…ˆå®¹å™¨é“¾ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> weaponIdentifier = <span class="string">"Weapon"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> parentContainer = <span class="keyword">new</span> Container();</span><br><span class="line">parentContainer.bind(weaponIdentifier).to(Katana);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> childContainer = <span class="keyword">new</span> Container();</span><br><span class="line">childContainer.parent = parentContainer;</span><br><span class="line"></span><br><span class="line">expect(childContainer.get(weaponIdentifier)).to.be.instanceOf(Katana); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="å¾ªç¯ä¾èµ–"><a href="#å¾ªç¯ä¾èµ–" class="headerlink" title="å¾ªç¯ä¾èµ–"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/circular_dependencies.md" target="_blank" rel="noopener">å¾ªç¯ä¾èµ–</a></h3><p>åœ¨ç±»çš„äº’ç›¸ä¾èµ–ä¸­ï¼Œæ˜¯å¾ˆå¯èƒ½å‡ºç°å¾ªç¯ä¾èµ–çš„æƒ…å†µçš„ã€‚</p>
<p><code>é”™è¯¯: æ‰¾åˆ°äº†å¾ªç¯ä¾èµ–ï¼šNinja -&gt; A -&gt; B -&gt; C -&gt; D -&gt; A</code></p>
<p>InversifyJS æ˜¯å¯ä»¥æ£€æµ‹åˆ°è¿™æ ·çš„æƒ…å†µçš„ï¼Œå¦‚æœä¸åšå¤„ç†ä¼šæç¤ºé”™è¯¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@inject å’Œ undefined ä¸€èµ·è¢«è°ƒç”¨äº†ï¼Œè¿™å¯èƒ½æ„å‘³ç€ç±» <span class="variable">$&#123;name&#125;</span> å­˜åœ¨ä¸€ä¸ªå¾ªç¯ä¾èµ–é—®é¢˜ã€‚ä½ å¯ä»¥ç”¨ LazyServiceIdentifer æ¥å…‹æœè¿™ä¸ªé™åˆ¶ã€‚</span><br></pre></td></tr></table></figure>
<p>ä½ æœ‰ä¸¤ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>LazyServiceIdentifer</code>ã€‚ æ‡’åŠ è½½è¯†åˆ«å™¨å¹¶ä¸å»¶è¿Ÿä¾èµ–æ³¨å…¥ï¼Œæ‰€æœ‰ä¾èµ–é¡¹éƒ½åœ¨ç±»å®ä¾‹åˆ›å»ºæ—¶æ³¨å…¥ã€‚ä½†æ˜¯ï¼Œå®ƒå»¶è¿Ÿäº†å¯¹å±æ€§è¯†åˆ«å™¨çš„è®¿é—®ï¼ˆè§£å†³äº†æ¨¡å—é—®é¢˜ï¼‰ã€‚ä¸€ä¸ªç›¸å…³çš„ä¾‹å­å¯ä»å®˜æ–¹æä¾›çš„<a href="https://github.com/krzkaczor/InversifyJS/blob/a53bf2cbee65803b197998c1df496c3be84731d9/test/inversify.test.ts#L236-L300" target="_blank" rel="noopener">å•å…ƒæµ‹è¯•</a>ä¸­æ‰¾åˆ°ã€‚</li>
<li>ä½¿ç”¨ <code>@lazyInject</code> è£…é¥°å™¨ã€‚è¯¥è£…é¥°å™¨æ˜¯ <a href="https://github.com/inversify/inversify-inject-decorators" target="_blank" rel="noopener"><code>inversify-inject-decorators</code></a> æ¨¡å—çš„ä¸€éƒ¨åˆ†ã€‚ <code>@lazyInject</code> è£…é¥°å™¨å°†å¯¹ä¾èµ–é¡¹çš„æ³¨å…¥å»¶è¿Ÿåˆ°äº†çœŸæ­£è¦ä½¿ç”¨å®ƒä»¬çš„é‚£ä¸€åˆ»ï¼Œè¿™å‘ç”Ÿåœ¨ç±»å®ä¾‹è¢«åˆ›å»ºä¹‹åã€‚</li>
</ul>
<h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a><a href="https://github.com/inversify/InversifyJS/blob/master/wiki/inheritance.md" target="_blank" rel="noopener">ç»§æ‰¿</a></h3><p>InvsersifyJS ä¸­å¯¹ç»§æ‰¿çš„ä½¿ç”¨æœ‰ä¸¤æ¡é™åˆ¶æ¡ä»¶ï¼š</p>
<ul>
<li>ä¸€ä¸ªå­ç±»å¿…é¡»æ˜¾å¼åœ°å£°æ˜å…¶æ„é€ å™¨ã€‚</li>
<li>å­ç±»çš„æ„é€ å™¨å‚æ•°æ•°é‡å¿…é¡»å¤§äºæˆ–ç­‰äºå…¶åŸºç±»çš„æ„é€ å™¨å‚æ•°æ•°é‡ã€‚</li>
</ul>
<p>å¦‚æœä½ ä¸å‡†å®ˆè¿™ä¸¤ä¸ªè§„åˆ™æ¡ä»¶åˆ™ä¼š _æ”¶è·_ å¼‚å¸¸è­¦å‘Šï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: The number of constructor arguments <span class="keyword">in</span> the derived class SamuraiMaster must be &gt;= than the number of constructor arguments of its base class.</span><br></pre></td></tr></table></figure>
<p>æœ‰å››ç§æ–¹æ³•æ¥è§£å†³å¯èƒ½å‡ºç°çš„ç»§æ‰¿æŠ¥é”™é—®é¢˜</p>
<h4 id="ä½¿ç”¨-unmanaged-è£…é¥°å™¨"><a href="#ä½¿ç”¨-unmanaged-è£…é¥°å™¨" class="headerlink" title="ä½¿ç”¨ @unmanaged è£…é¥°å™¨"></a>ä½¿ç”¨ @unmanaged è£…é¥°å™¨</h4><p><code>@unmanaged()</code> è£…é¥°å™¨è¿è¡Œç”¨æˆ·æ ‡è®°ä¸€ä¸ªå‚æ•°å°†ä¼šè¢«æ‰‹åŠ¨æ³¨å…¥åˆ°åŸºç±»ã€‚æˆ‘ä»¬ä½¿ç”¨ â€œunmanagedâ€ ä¸€è¯å› ä¸º InversifyJS å¯¹ç”¨æˆ·æä¾›çš„å€¼æ²¡æœ‰æ§åˆ¶æƒï¼Œå°±ä¸èƒ½ç®¡ç†å®ƒä»¬çš„æ³¨å…¥è¡Œä¸ºã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BaseId = <span class="string">"Base"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Base &#123;</span><br><span class="line">  <span class="keyword">public</span> prop: <span class="built_in">string</span>;</span><br><span class="line">  public constructor(@unmanaged() arg: string) &#123;</span><br><span class="line">    <span class="keyword">this</span>.prop = arg;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Derived <span class="keyword">extends</span> Base &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">super</span>(<span class="string">"unmanaged-injected-value"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">container.bind&lt;Base&gt;(BaseId).to(Derived);</span><br><span class="line"><span class="keyword">let</span> derived = container.get&lt;Base&gt;(BaseId);</span><br><span class="line"></span><br><span class="line">derived <span class="keyword">instanceof</span> Derived2; <span class="comment">// true</span></span><br><span class="line">derived.prop; <span class="comment">// "unmanaged-injected-value"</span></span><br></pre></td></tr></table></figure>
<h4 id="å±æ€§è®¾ç½®å™¨"><a href="#å±æ€§è®¾ç½®å™¨" class="headerlink" title="å±æ€§è®¾ç½®å™¨"></a>å±æ€§è®¾ç½®å™¨</h4><p>ä½ å¯ä»¥ä½¿ç”¨ <code>public</code>ã€ <code>protected</code> æˆ–è€… <code>private</code> è®¿é—®æƒé™æ ‡è®°å’Œä¸€ä¸ªå±æ€§è®¾ç½®å™¨æ¥é¿å…æ³¨å…¥åˆ°åŸºç±»ä¸­ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">protected</span> rank: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// args count = 0</span></span><br><span class="line">    <span class="keyword">this</span>.rank = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> SamuraiMaster <span class="keyword">extends</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// args count = 0</span></span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.rank = <span class="string">"master"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å±æ€§æ³¨å…¥"><a href="#å±æ€§æ³¨å…¥" class="headerlink" title="å±æ€§æ³¨å…¥"></a>å±æ€§æ³¨å…¥</h4><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å±æ€§æ³¨å…¥æ¥é¿å…æ³¨å…¥åˆ°åŸºç±»ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">protected</span> rank: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;&#125; <span class="comment">// args count = 0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> TYPES = &#123; Rank: <span class="string">"Rank"</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> SamuraiMaster <span class="keyword">extends</span> Warrior &#123;</span><br><span class="line">  <span class="meta">@injectNamed</span>(TYPES.Rank, <span class="string">"master"</span>)</span><br><span class="line">  <span class="meta">@named</span>(<span class="string">"master"</span>)</span><br><span class="line">  <span class="keyword">protected</span> rank: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// args count = 0</span></span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">container</span><br><span class="line">  .bind&lt;<span class="built_in">string</span>&gt;(TYPES.Rank)</span><br><span class="line">  .toConstantValue(<span class="string">"master"</span>)</span><br><span class="line">  .whenTargetNamed(<span class="string">"master"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨å…¥åˆ°å­ç±»"><a href="#æ³¨å…¥åˆ°å­ç±»" class="headerlink" title="æ³¨å…¥åˆ°å­ç±»"></a>æ³¨å…¥åˆ°å­ç±»</h4><p>å¦‚æœæˆ‘ä»¬ä¸æƒ³é¿å…æ³¨å…¥åˆ°åŸºç±»æˆ‘ä»¬å¯ä»¥æ³¨å…¥åˆ°å­ç±»ç„¶åä½¿ç”¨åŸºç±»çš„æ„é€ å™¨ï¼ˆsuperï¼‰æ³¨å…¥åˆ°åŸºç±»ã€‚</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">protected</span> rank: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">rank: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="comment">// args count = 1</span></span><br><span class="line">    <span class="keyword">this</span>.rank = rank;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> TYPES = &#123; Rank: <span class="string">"Rank"</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> SamuraiMaster <span class="keyword">extends</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Rank) @named("master") rank: string // args count = 1</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">super</span>(rank);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">container</span><br><span class="line">  .bind&lt;<span class="built_in">string</span>&gt;(TYPES.Rank)</span><br><span class="line">  .toConstantValue(<span class="string">"master"</span>)</span><br><span class="line">  .whenTargetNamed(<span class="string">"master"</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ä»£ç ä¹Ÿå¯è¡Œï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">protected</span> rank: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">rank: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="comment">// args count = 1</span></span><br><span class="line">    <span class="keyword">this</span>.rank = rank;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Weapon &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Katana <span class="keyword">implements</span> Weapon &#123;</span><br><span class="line">  <span class="keyword">public</span> name: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"Katana"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> TYPES = &#123;</span><br><span class="line">  Rank: <span class="string">"Rank"</span>,</span><br><span class="line">  Weapon: <span class="string">"Weapon"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> SamuraiMaster <span class="keyword">extends</span> Warrior &#123;</span><br><span class="line">  <span class="keyword">public</span> weapon: Weapon;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line">    @inject(TYPES.Rank) @named("master") rank: string, // args count = 2</span><br><span class="line">    <span class="meta">@inject</span>(TYPES.Weapon) weapon: Weapon</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">super</span>(rank);</span><br><span class="line">    <span class="keyword">this</span>.weapon = weapon;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">container.bind&lt;Weapon&gt;(TYPES.Weapon).to(Katana);</span><br><span class="line"></span><br><span class="line">container</span><br><span class="line">  .bind&lt;<span class="built_in">string</span>&gt;(TYPES.Rank)</span><br><span class="line">  .toConstantValue(<span class="string">"master"</span>)</span><br><span class="line">  .whenTargetNamed(<span class="string">"master"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨"><a href="#ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨" class="headerlink" title="ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨"></a>ç¬¬ä¸‰æ–¹åŸºç±»ä½¿ç”¨</h3><p>æŸäº›æƒ…å†µä¸‹ï¼Œä½ ä¹Ÿè®¸ä¼šç¢°åˆ°é”™è¯¯è¯´ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—æä¾›çš„ç±»ç¼ºå°‘æ ‡è®°ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Missing required @injectable annotation <span class="keyword">in</span>: SamuraiMaster</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>decorate</code> å‡½æ•°æ¥å…‹æœè¿™ä¸ªé—®é¢˜ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; decorate, injectable &#125; <span class="keyword">from</span> <span class="string">"inversify"</span>;</span><br><span class="line"><span class="keyword">import</span> SomeClass <span class="keyword">from</span> <span class="string">"some-module"</span>;</span><br><span class="line"></span><br><span class="line">decorate(injectable(), SomeClass);</span><br><span class="line"><span class="keyword">return</span> SomeClass;</span><br></pre></td></tr></table></figure>
<h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><p>InversifyJS æ˜¯ä¸€ä¸ª IoC å®¹å™¨ï¼Œä¸€ä¸ª IoC å®¹å™¨æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ¥å¸®åŠ©ä½ å†™å‡ºéšæ—¶é—´æ¨ç§»å®¹æ˜“ä¿®æ”¹å’Œæ‰©å±•çš„é¢å‘å¯¹è±¡çš„ä»£ç ã€‚</p>
<h3 id="ç»„åˆé‡ç”¨åŸåˆ™"><a href="#ç»„åˆé‡ç”¨åŸåˆ™" class="headerlink" title="ç»„åˆé‡ç”¨åŸåˆ™"></a>ç»„åˆé‡ç”¨åŸåˆ™</h3><blockquote>
<p>â€˜å¯¹è±¡ç»„åˆâ€™ä¼˜äºâ€˜ç±»ç»§æ‰¿â€™ã€‚</p>
</blockquote>
<p>ç»§æ‰¿æ˜¯ä¸€ä»¶åäº‹æƒ…ï¼Œå› ä¸ºå®ƒå¸¦æ¥äº†æ¨¡å—é—´çš„æœ€å¼ºè€¦åˆæ€§ã€‚</p>
<h3 id="ä¾èµ–å€’ç½®åŸåˆ™"><a href="#ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™"></a>ä¾èµ–å€’ç½®åŸåˆ™</h3><blockquote>
<p>è¦ä¾èµ–æŠ½è±¡ï¼Œè€Œä¸è¦ä¾èµ–å…·ä½“å®ç°ã€‚</p>
</blockquote>
<p>ä¾èµ–æ³¨å…¥æ— éæ˜¯é€šè¿‡æ„é€ å™¨æˆ–è€…è®¾ç½®å™¨å°†ä¾èµ–ä¼ é€’ç»™ç±»</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Katana;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">katana: Katana</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> fight() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­ Ninja ç±»ä¾èµ– Katana ç±»: <code>Ninja --&gt; Katana</code></p>
<p>æ³¨æ„ç®­å¤´æ–¹å‘è¡¨ç¤ºäº†ä¾èµ–æ˜¯ä»å·¦åˆ°å³çš„ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ›´æ–° Ninja ç±»æ¥ä¾èµ– Katana ç±»çš„æŠ½è±¡ï¼ˆå³ Katana æ¥å£ï¼‰ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@injectable</span>()</span><br><span class="line"><span class="keyword">class</span> Ninja &#123;</span><br><span class="line">  <span class="keyword">private</span> _katana: Katana;</span><br><span class="line"></span><br><span class="line">  public constructor(@inject("Katana") katana: Katana) &#123;</span><br><span class="line">    <span class="keyword">this</span>._katana = katana;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> fight() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._katana.hit();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒNinja ç±»å’Œ Katana ç±»éƒ½ä¾èµ–äº Katana æ¥å£ï¼š</p>
<p><code>Ninja --&gt; Katana</code></p>
<p><code>Ninja --&gt; Katana</code></p>
<p>ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p><code>Ninja --&gt; Katana &lt;-- Katana</code></p>
<h3 id="é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º"><a href="#é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º" class="headerlink" title="é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º"></a>é¿å…æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸º</h3><p>æ³¨å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œä¸ºï¼Œæ˜¯æ”¿æ²»å®¶åæ¨¡å¼çš„ä¸€ä¸ªå­ç±»å‹ï¼Œåªæ˜¯åœ¨è¿™é‡Œå®¹å™¨æ˜¯é‚£ä¸ªæ²¡ç”¨çš„ç±»ã€‚å¦‚æœä¸€ä¸ªç±»éœ€è¦çŸ¥é“å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦æ³¨å…¥ä¸€ä¸ªæ—¥æœŸå’Œæ—¶é—´ï¼Œå³æ•°æ®ï¼›ç›¸åçš„ï¼Œä½ åº”è¯¥æ³¨å…¥ä¸€ä¸ªç³»ç»Ÿæ—¶é’Ÿçš„ä¸Šå±‚æŠ½è±¡ã€‚è¿™ä¸ä»…ä»…åœ¨ DI æ—¶æ˜¯æ­£ç¡®çš„åšæ³•ï¼›è¿™å¯¹å¯æµ‹æ€§è‡³å…³é‡è¦ï¼Œå› ä¸ºä½ å¯ä»¥ä¸å¿…ç­‰å¾…å°±èƒ½å¤Ÿæµ‹è¯•ä¸åŒçš„æ—¶é—´ä¸‹çš„è¡Œä¸ºã€‚</p>
<h3 id="é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹"><a href="#é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹" class="headerlink" title="é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹"></a>é¿å…å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹</h3><p>å°†æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸ºå•ä¾‹ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œè¿™å°±æ˜¯è´§ç‰©å´‡æ‹œç¼–ç¨‹çš„å®Œç¾ä¾‹å­ï¼Œç®€ç›´æ˜¯ä¿—ç§°çš„â€œå¯¹è±¡æ±¡æ°´æ± â€ã€‚æˆ‘çœ‹è¿‡å¤šåˆ°æˆ‘è®°ä¸ä½çš„å•ä¾‹æ»¥ç”¨æ¡ˆä¾‹ï¼Œå…¶ä¸­å¾ˆå°‘å’Œ DI ç›¸å…³ã€‚</p>
<h3 id="é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥"><a href="#é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥" class="headerlink" title="é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥"></a>é¿å…æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥</h3><p>æ„é€ å™¨çš„è¿‡åº¦æ³¨å…¥è¿åäº†å•ä¸€èŒè´£åŸåˆ™ã€‚å¤ªå¤šçš„æ„é€ å™¨å‚æ•°è¡¨æ˜äº†å¤ªå¤šçš„ä¾èµ–ï¼›å¤ªå¤šçš„ä¾èµ–è¡¨æ˜äº†è¿™ä¸ªç±»å°è¯•åšå¾—å¤ªå¤šäº†ã€‚é€šå¸¸è¿™ä¸ªé”™è¯¯ä¼´éšç€å…¶ä»–çš„ä»£ç åå‘³é“ï¼Œæ¯”å¦‚é€šå¸¸æœ‰ç€å¾ˆé•¿è€Œä¸”æ¨¡ç³Šçš„ç±»åç§°ï¼ˆxxxManager ä¹‹ç±»ï¼‰ã€‚</p>
<h2 id="Refer-To"><a href="#Refer-To" class="headerlink" title="Refer To"></a>Refer To</h2><p><a href="https://github.com/inversify/InversifyJS/tree/master/wiki" target="_blank" rel="noopener">https://github.com/inversify/InversifyJS/tree/master/wiki</a></p>
<p><a href="https://doc.inversify.cloud/zh_cn/" target="_blank" rel="noopener">https://doc.inversify.cloud/zh_cn/</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/137542149" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/137542149</a></p>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>åŸæ–‡ä½œè€…: </span>
      <a href="https://fynn90.github.io">Fynn</a>
    </p>
    <p class="copyright-item">
      <span>åŸæ–‡é“¾æ¥: </span>
      <a href="https://fynn90.github.io/2021/02/18/InversifyJS/">https://fynn90.github.io/2021/02/18/InversifyJS/</a>
    </p>
    <p class="copyright-item">
      <span>è®¸å¯åè®®: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a>
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">èµèµæ”¯æŒ</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/InversifyJS/">InversifyJS</a>
            
              <a href="/tags/IoC/">IoC</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2021/03/03/RxJS/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">RxJS</span>
        <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
      </a>
    
    
      <a class="next" href="/2021/02/04/æµè§ˆå™¨ä¸­è·¨é¡µé¢çš„é€šè®¯/">
        <span class="next-text nav-default">æµè§ˆå™¨è·¨é¡µé¢é€šè®¯</span>
        <span class="prev-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:fynn.90@outlook.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
        
          <a href="https://www.linkedin.com/in/%E5%B8%86-%E9%82%93-17163589/" class="iconfont icon-linkedin" title="linkedin"></a>
        
      
    
      
        
          <a href="https://plus.google.com/u/0/117459332873536225443" class="iconfont icon-google" title="google"></a>
        
      
    
      
        
          <a href="https://github.com/fynn90" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://www.weibo.com/306019091" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a href="https://www.zhihu.com/people/FynnDeng/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
      
    
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2021

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Fynn</span>
  </span>
  
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
