<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Linux用户和权限管理"/>




  <meta name="keywords" content="Linux," />




  <link rel="alternate" href="/atom.xml" title="Fynn's Blog" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1.2" />



<link rel="canonical" href="https://fynn90.github.io/2019/05/06/Linux用户和权限管理/"/>


<meta name="description" content="Linux账户体系分为用户和群组,一个用户可以属于多个群组.而Linux里面一切皆是文件,而对文件的权限分为三类:拥有者,群组,其他. 针对不同的用户需求,应该创建不同的账户和群组.使它们只能针对特定的文件或目录拥有权限,这样最大限度的保证系统的安全.">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux用户和权限管理">
<meta property="og:url" content="https://fynn90.github.io/2019/05/06/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Fynn&#39;s Blog">
<meta property="og:description" content="Linux账户体系分为用户和群组,一个用户可以属于多个群组.而Linux里面一切皆是文件,而对文件的权限分为三类:拥有者,群组,其他. 针对不同的用户需求,应该创建不同的账户和群组.使它们只能针对特定的文件或目录拥有权限,这样最大限度的保证系统的安全.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2019/05/05/5cce88242c7d7.gif">
<meta property="article:published_time" content="2019-05-06T11:40:00.000Z">
<meta property="article:modified_time" content="2019-05-06T11:36:39.369Z">
<meta property="article:author" content="Fynn">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/05/05/5cce88242c7d7.gif">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1.2" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?607980a031d3edcefed502ce80e77ffb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-115728733-1', 'auto');
        ga('send', 'pageview');
  </script>



    <title> Linux用户和权限管理 · Fynn's Blog </title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Fynn's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Fynn's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Linux用户和权限管理
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2019年5月6日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#UID%E5%92%8CGID"><span class="toc-text">UID和GID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%92%8C%E7%BE%A4%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AE%A1%E7%90%86%E6%96%87%E4%BB%B6"><span class="toc-text">用户和群信息的管理文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-passwd"><span class="toc-text">&#x2F;etc&#x2F;passwd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-shadow"><span class="toc-text">&#x2F;etc&#x2F;shadow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-group"><span class="toc-text">&#x2F;etc&#x2F;group</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E6%95%88%E7%BE%A4%E7%BB%84%E5%92%8C%E5%88%9D%E5%A7%8B%E7%BE%A4%E7%BB%84"><span class="toc-text">有效群组和初始群组</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-gshadow"><span class="toc-text">&#x2F;etc&#x2F;gshadow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text">用户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useradd"><span class="toc-text">useradd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passwd"><span class="toc-text">passwd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chpasswd"><span class="toc-text">chpasswd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chage"><span class="toc-text">chage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usermod"><span class="toc-text">usermod</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#userdel"><span class="toc-text">userdel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#finger"><span class="toc-text">finger</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chfn"><span class="toc-text">chfn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chsh"><span class="toc-text">chsh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#id"><span class="toc-text">id</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%A4%E7%AE%A1%E7%90%86"><span class="toc-text">群管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#groupadd"><span class="toc-text">groupadd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#groupmod"><span class="toc-text">groupmod</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#groupdel"><span class="toc-text">groupdel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gpasswd"><span class="toc-text">gpasswd</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACL"><span class="toc-text">ACL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#setfacl"><span class="toc-text">setfacl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getfacl"><span class="toc-text">getfacl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#su"><span class="toc-text">su</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#w-who"><span class="toc-text">w&#x2F;who</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%88%B7%E7%AE%A1%E7%90%86%E4%BE%8B%E5%AD%90"><span class="toc-text">账户管理例子</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p>Linux账户体系分为用户和群组,一个用户可以属于多个群组.而Linux里面一切皆是文件,而对文件的权限分为三类:<strong>拥有者</strong>,<strong>群组</strong>,<strong>其他</strong>.</p>
<p>针对不同的用户需求,应该创建不同的账户和群组.使它们只能针对特定的文件或目录拥有权限,这样最大限度的保证系统的安全.</p>
<span id="more"></span>
<h2 id="UID和GID"><a href="#UID和GID" class="headerlink" title="UID和GID"></a>UID和GID</h2><p>每个Linux账户拥有至少两个ID,UID(User id)和GID(Group id).它们分别表示用户id和群组id.</p>
<p>Linux主机通过这两个id识别当前用户拥有的权限有哪些.</p>
<h2 id="用户和群信息的管理文件"><a href="#用户和群信息的管理文件" class="headerlink" title="用户和群信息的管理文件"></a>用户和群信息的管理文件</h2><h3 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h3><p><code>/etc/passwd</code>保存着当前主机上所有的用户信息.</p>
<p>这个文件的构造是这样的：每一行都代表一个账号，有几行就代表有几个账号在你的系统中！ 不过需要特别留意的是，里头很多账号本来就是系统正常运行所必须要的，我们可以简称他为系统账号， 例如 bin, daemon, adm, nobody 等等，这些账号请不要随意的杀掉他呢！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># head -n 4 /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash  &lt;==等一下做为底下说明用</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">[账号名称]:[口令]:[UID]:[GID]:[用户信息说明栏]:[家目录]:[Shell]</span><br></pre></td></tr></table></figure>

<p>注意:上面👆每一行代表一个用户.而每一行被<code>:</code>分割开,拥有不同的含义:</p>
<ol>
<li><p><strong>账号名称</strong>：<br>就是账号啦！用来对应 UID 的。例如 root 的 UID 对应就是 0 (第三字段)；</p>
</li>
<li><p><strong>口令</strong>：<br>早期 Unix 系统的口令就是放在这字段上！但是因为这个文件的特性是所有的程序都能够读取，这样一来很容易造成口令数据被窃取， 因此后来就将这个字段的口令数据给他改放到 <a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0410accountmanager.php#shadow_file">/etc/shadow</a> 中了。所以这里你会看到一个『 x 』，呵呵！</p>
</li>
<li><p><strong>UID：</strong></p>
<p>这个就是使用者标识符啰！通常 Linux 对于 UID 有几个限制需要说给您了解一下：</p>
<table>
<thead>
<tr>
<th>id 范围</th>
<th>该 ID 使用者特性</th>
</tr>
</thead>
<tbody><tr>
<td>0 (系统管理员)</td>
<td>当 UID 是 0 时，代表这个账号是『系统管理员』！ 所以当你要让其他的账号名称也具有 root 的权限时，将该账号的 UID 改为 0 即可。 这也就是说，一部系统上面的系统管理员不见得只有 root 喔！ 不过，很不建议有多个账号的 UID 是 0 啦～</td>
</tr>
<tr>
<td>1~499 (系统账号)</td>
<td>保留给系统使用的 ID，其实除了 0 之外，其他的 UID 权限与特性并没有不一样。默认 500 以下的数字让给系统作为保留账号只是一个习惯。  由于系统上面启动的服务希望使用较小的权限去运行，因此不希望使用 root 的身份去运行这些服务， 所以我们就得要提供这些运行中程序的拥有者账号才行。这些系统账号通常是不可登陆的， 所以才会有我们在<a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0320bash.php">第十一章</a>提到的 /sbin/nologin 这个特殊的 shell 存在。  根据系统账号的由来，通常系统账号又约略被区分为两种： 1<del>99：由 distributions 自行创建的系统账号； 100</del>499：若用户有系统账号需求时，可以使用的账号 UID。</td>
</tr>
<tr>
<td>500~65535 (可登陆账号)</td>
<td>给一般使用者用的。事实上，目前的 linux 核心 (2.6.x 版)已经可以支持到 4294967295 (2^32-1) 这么大的 UID 号码喔！</td>
</tr>
</tbody></table>
<p>上面这样说明可以了解了吗？是的， UID 为 0 的时候，就是 root 呦！所以请特别留意一下你的 /etc/passwd 文件！</p>
</li>
<li><p><strong>GID</strong>：<br>这个与 /etc/group 有关！其实 /etc/group 的观念与 /etc/passwd 差不多，只是他是用来规范组名与 GID 的对应而已！</p>
</li>
<li><p><strong>用户信息说明栏</strong>：<br>这个字段基本上并没有什么重要用途，只是用来解释这个账号的意义而已！不过，如果您提供使用 finger 的功能时， 这个字段可以提供很多的信息呢！本章后面的 <a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0410accountmanager.php#chfn">chfn</a> 命令会来解释这里的说明。</p>
</li>
<li><p><strong>家目录</strong>：<br>这是用户的家目录，以上面为例， root 的家目录在 /root ，所以当 root 登陆之后，就会立刻跑到 /root 目录里头啦！呵呵！ 如果你有个账号的使用空间特别的大，你想要将该账号的家目录移动到其他的硬盘去该怎么作？ 没有错！可以在这个字段进行修改呦！默认的用户家目录在 /home/yourIDname</p>
</li>
<li><p><strong>Shell</strong>：<br>我们在<a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0320bash.php">第十一章 BASH</a> 提到很多次，当用户登陆系统后就会取得一个 Shell 来与系统的核心沟通以进行用户的操作任务。那为何默认 shell 会使用 bash 呢？就是在这个字段指定的啰！ 这里比较需要注意的是，有一个 shell 可以用来替代成让账号无法取得 shell 环境的登陆动作！那就是 /sbin/nologin 这个东西！这也可以用来制作纯 pop 邮件账号者的数据呢！</p>
</li>
</ol>
<h3 id="etc-shadow"><a href="#etc-shadow" class="headerlink" title="/etc/shadow"></a>/etc/shadow</h3><p><code>/etc/shadow</code>保存着用户账户的口令,它的数据和<code>/etc/passwd</code>是对应的.它每一行表示一个用户的口令信息.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># head -n 4 /etc/shadow</span></span><br><span class="line">root:$1$/30QpE5e<span class="variable">$y9N</span>/D0bh6rAACBEz.hqo00:14126:0:99999:7:::  &lt;==底下说明用</span><br><span class="line">bin:*:14126:0:99999:7:::</span><br><span class="line">daemon:*:14126:0:99999:7:::</span><br><span class="line">adm:*:14126:0:99999:7:::</span><br></pre></td></tr></table></figure>

<ol>
<li><p><strong>账号名称</strong>：<br>由于口令也需要与账号对应啊～因此，这个文件的第一栏就是账号，必须要与 <code>/etc/passwd</code> 相同才行！</p>
</li>
<li><p><strong>口令</strong>：<br>这个字段内的数据才是真正的口令，而且是经过编码的口令 (加密) 啦！ 你只会看到有一些特殊符号的字母就是了！需要特别留意的是，虽然这些加密过的口令很难被解出来， 但是『很难』不等于『不会』，所以，这个文件的默认权限是<code>『-rw———』</code>或者是<code>『-r————』</code>，亦即只有 root 才可以读写就是了！你得随时注意，不要不小心更动了这个文件的权限呢！</p>
<p>另外，由于各种口令编码的技术不一样，因此不同的编码系统会造成这个字段的长度不相同。 举例来说，旧式的 DES 编码系统产生的口令长度就与目前惯用的 MD5 不同(<a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0410accountmanager.php#ps2">注2</a>)！MD5 的口令长度明显的比较长些。由于固定的编码系统产生的口令长度必须一致，因此『当你让这个字段的长度改变后，该口令就会失效(算不出来)』。 很多软件透过这个功能，在此字段前加上 ! 或 * 改变口令字段长度，就会让口令『暂时失效』了。 </p>
</li>
<li><p><strong>最近更动口令的日期：</strong></p>
<p>这个字段记录了『更动口令那一天』的日期，不过，很奇怪呀！在我的例子中怎么会是 14126 呢？呵呵，这个是因为计算 Linux 日期的时间是以 1970 年 1 月 1 日作为 1 而累加的日期，1971 年 1 月 1 日则为 366 啦！ 得注意一下这个数据呦！上述的 14126 指的就是 2008-09-04 那一天啦！了解乎？ 而想要了解该日期可以使用本章后面<a href="%5Bhttp://man.linuxde.net/chage%5D(http://man.linuxde.net/chage)"><code>chage</code></a>命令的帮忙！至于想要知道某个日期的累积日数， 可使用如下的程序计算：</p>
<p>上述命令中，2008/09/04 为你想要计算的日期，86400 为每一天的秒数， %s 为 1970/01/01 以来的累积总秒数。 由于 bash 仅支持整数，因此最终需要加上 1 补齐 1970/01/01 当天。</p>
</li>
<li><p><strong>口令不可被更动的天数</strong>：(与第 3 字段相比)<br>第四个字段记录了：这个账号的口令在最近一次被更改后需要经过几天才可以再被变更！如果是 0 的话， 表示口令随时可以更动的意思。这的限制是为了怕口令被某些人一改再改而设计的！如果配置为 20 天的话，那么当你配置了口令之后， 20 天之内都无法改变这个口令呦！</p>
</li>
<li><p><strong>口令需要重新变更的天数</strong>：(与第 3 字段相比)<br>经常变更口令是个好习惯！为了强制要求用户变更口令，这个字段可以指定在最近一次更改口令后， 在多少天数内需要再次的变更口令才行。你必须要在这个天数内重新配置你的口令，否则这个账号的口令将会『变为过期特性』。 而如果像上面的 99999 (计算为 273 年) 的话，那就表示，呵呵，口令的变更没有强制性之意。</p>
</li>
<li><p><strong>口令需要变更期限前的警告天数</strong>：(与第 5 字段相比)<br>当账号的口令有效期限快要到的时候 (第 5 字段)，系统会依据这个字段的配置，发出『警告』言论给这个账号，提醒他『再过 n 天你的口令就要过期了，请尽快重新配置你的口令呦！』，如上面的例子，则是口令到期之前的 7 天之内，系统会警告该用户。</p>
</li>
<li><p>**口令过期后的账号宽限时间(口令失效日)**：(与第 5 字段相比)<br>口令有效日期为『升级日期(第3字段)』+『重新变更日期(第5字段)』，过了该期限后用户依旧没有升级口令，那该口令就算过期了。 虽然口令过期但是该账号还是可以用来进行其他工作的，包括登陆系统取得 bash 。不过如果口令过期了， 那当你登陆系统时，系统会强制要求你必须要重新配置口令才能登陆继续使用喔，这就是口令过期特性。</p>
<p>那这个字段的功能是什么呢？是在口令过期几天后，如果使用者还是没有登陆更改口令，那么这个账号的口令将会『失效』， 亦即该账号再也无法使用该口令登陆了。要注意口令过期与口令失效并不相同。</p>
</li>
<li><p><strong>账号失效日期</strong>：<br>这个日期跟第三个字段一样，都是使用 1970 年以来的总日数配置。这个字段表示： 这个账号在此字段规定的日期之后，将无法再使用。 就是所谓的『账号失效』，此时不论你的口令是否有过期，这个『账号』都不能再被使用！ 这个字段会被使用通常应该是在『收费服务』的系统中，你可以规定一个日期让该账号不能再使用啦！</p>
</li>
<li><p><strong>保留</strong>：<br>最后一个字段是保留的，看以后有没有新功能加入。</p>
</li>
</ol>
<h3 id="etc-group"><a href="#etc-group" class="headerlink" title="/etc/group"></a>/etc/group</h3><p><code>/etc/group</code>保存着主机所有群组的信息,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># head -n 4 /etc/group</span></span><br><span class="line">root:x:0:root</span><br><span class="line">bin:x:1:root,bin,daemon</span><br><span class="line">daemon:x:2:root,bin,daemon</span><br><span class="line">sys:x:3:root,bin,adm</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>组名</strong>：<br>就是组名啦！</li>
<li><strong>群组口令</strong>：<br>通常不需要配置，这个配置通常是给『群组管理员』使用的，目前很少有这个机会配置群组管理员啦！ 同样的，口令已经移动到 /etc/gshadow 去，因此这个字段只会存在一个『x』而已；</li>
<li><strong>GID</strong>：<br>就是群组的 ID 啊。我们 /etc/passwd 第四个字段使用的 GID 对应的群组名，就是由这里对应出来的！</li>
<li><strong>此群组支持的账号名称</strong>：<br>我们知道一个账号可以加入多个群组，那某个账号想要加入此群组时，将该账号填入这个字段即可。 举例来说，如果我想要让 dmtsai 也加入 root 这个群组，那么在第一行的最后面加上『,dmtsai』，注意不要有空格， 使成为『 root:X:0:root,dmtsai 』就可以啰～</li>
</ol>
<p><code>/etc/group</code>、<code>/etc/passwd</code>、<code>/etc/shadow</code>之间的关系如下图:</p>
<p><img src="https://i.loli.net/2019/05/05/5cce88242c7d7.gif"></p>
<h4 id="有效群组和初始群组"><a href="#有效群组和初始群组" class="headerlink" title="有效群组和初始群组"></a>有效群组和初始群组</h4><p>在<code>/etc/passwd</code>中第四栏的GID表示的是用户的初始群组.当用户一登陆系统，立刻就拥有这个群组的相关权限的意思.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># usermod -G users dmtsai  &lt;==先配置好次要群组</span></span><br><span class="line">[root@www ~]<span class="comment"># grep dmtsai /etc/passwd /etc/group /etc/gshadow</span></span><br><span class="line">/etc/passwd:dmtsai:x:503:504::/home/dmtsai:/bin/bash</span><br><span class="line">/etc/group:users:x:100:dmtsai  &lt;==次要群组的配置</span><br><span class="line">/etc/group:dmtsai:x:504:       &lt;==因为是初始群组，所以第四字段不需要填入账号</span><br><span class="line">/etc/gshadow:users:::dmtsai    &lt;==次要群组的配置</span><br><span class="line">/etc/gshadow:dmtsai:!::</span><br></pre></td></tr></table></figure>

<p>仔细看到上面这个表格，在<code>/etc/passwd</code>里面，dmtsai 这个使用者所属的群组为 GID=504 ，搜寻一下 <code>/etc/group</code> 得到 <strong>504</strong> 是那个名为 dmtsai 的群组啦！这就是 <strong>initial group</strong>。因为是初始群组， 使用者一登陆就会主动取得，不需要在<code> /etc/group</code> 的第四个字段写入该账号的！</p>
<p>但是非 <strong>initial group</strong> 的其他群组可就不同了。举上面这个例子来说，我将 dmtsai 加入 users 这个群组当中，由于 users 这个群组并非是 dmtsai 的初始群组，因此， 我必须要在 <code>/etc/group</code> 这个文件中，找到 users 那一行，并且将 dmtsai 这个账号加入第四栏， 这样 dmtsai 才能够加入 users 这个群组啊。</p>
<p>那么在这个例子当中，因为我的 dmtsai 账号同时支持 dmtsai 与 users 这两个群组， 因此，在读取/写入/运行文件时，针对群组部分，只要是 users 与 dmtsai 这两个群组拥有的功能， 我 dmtsai 这个使用者都能够拥有喔！这样瞭呼？<strong>不过，这是针对已经存在的文件而言， 如果今天我要创建一个新的文件或者是新的目录，请问一下，新文件的群组是 dmtsai 还是 users ？呵呵！这就得要检查一下当时的有效群组了 (effective group)。</strong></p>
<p>可以通过<code>groups</code>查看当前用户所拥有的群组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[dmtsai@www ~]$ groups</span><br><span class="line">dmtsai users</span><br><span class="line">[dmtsai@www ~]$ touch <span class="built_in">test</span></span><br><span class="line">[dmtsai@www ~]$ ll</span><br><span class="line">-rw-rw-r-- 1 dmtsai dmtsai 0 Feb 24 17:26 <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p><code>groups</code>命令输出的一个群组名就是当前用户的有效群组,用户创建的文件或目录都是属于这个群组的.</p>
<p>可以通过<code>newgrp</code>更改有效群组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[dmtsai@www ~]$ newgrp users</span><br><span class="line">[dmtsai@www ~]$ groups</span><br><span class="line">users dmtsai</span><br><span class="line">[dmtsai@www ~]$ touch test2</span><br><span class="line">[dmtsai@www ~]$ ll</span><br><span class="line">-rw-rw-r-- 1 dmtsai dmtsai 0 Feb 24 17:26 <span class="built_in">test</span></span><br><span class="line">-rw-r--r-- 1 dmtsai users  0 Feb 24 17:33 test2</span><br></pre></td></tr></table></figure>

<p>不过使用 <code>newgrp</code> 是有限制的，那就是你想要切换的群组必须是你已经有支持的群组。</p>
<h3 id="etc-gshadow"><a href="#etc-gshadow" class="headerlink" title="/etc/gshadow"></a>/etc/gshadow</h3><p><code>/etc/gshadow</code>保存着群组口令和群主管理员信息.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># head -n 4 /etc/gshadow</span></span><br><span class="line">root:::root</span><br><span class="line">bin:::root,bin,daemon</span><br><span class="line">daemon:::root,bin,daemon</span><br><span class="line">sys:::root,bin,adm</span><br></pre></td></tr></table></figure>

<p>这个文件内同样还是使用冒号『:』来作为字段的分隔字符，而且你会发现，这个文件几乎与 <code>/etc/group</code> 一模一样啊！是这样没错～不过，要注意的大概就是第二个字段吧～第二个字段是口令栏， 如果口令栏上面是『!』时，表示该群组不具有群组管理员！至于第四个字段也就是支持的账号名称啰～ 这四个字段的意义为：</p>
<ol>
<li>组名</li>
<li>口令栏，同样的，开头为 ! 表示无合法口令，所以无群组管理员</li>
<li>群组管理员的账号 (相关信息在 <a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0410accountmanager.php#gpasswd">gpasswd</a> 中介绍)</li>
<li>该群组的所属账号 (与 <code>/etc/group</code> 内容相同！)</li>
</ol>
<p>以系统管理员的角度来说，这个 <code>gshadow</code> 最大的功能就是创建群组管理员啦！ 那么什么是群组管理员呢？由于系统上面的账号可能会很多，但是我们 root 可能平时太忙碌，所以当有使用者想要加入某些群组时， root 或许会没有空管理。此时如果能够创建群组管理员的话，那么该群组管理员就能够将那个账号加入自己管理的群组中！ 可以免去 root 的忙碌啦！</p>
<h2 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h2><h3 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a><a href="%5Bhttp://man.linuxde.net/useradd%5D(http://man.linuxde.net/useradd)">useradd</a></h3><p><code>useradd</code> 用来创建新用户,并且可以指定用户的初始群组和所属群组.但它不能设定账户的口令!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># useradd [-u UID] [-g 初始群组] [-G 次要群组] [-mM]\</span></span><br><span class="line">&gt;  [-c 说明栏] [-d 家目录绝对路径] [-s shell] 使用者账号名</span><br><span class="line">选项与参数：</span><br><span class="line">-u  ：后面接的是 UID ，是一组数字。直接指定一个特定的 UID 给这个账号；</span><br><span class="line">-g  ：后面接的那个组名就是我们上面提到的 initial group 啦～</span><br><span class="line">      该群组的 GID 会被放置到 /etc/passwd 的第四个字段内。</span><br><span class="line">-G  ：后面接的组名则是这个账号还可以加入的群组。</span><br><span class="line">      这个选项与参数会修改 /etc/group 内的相关数据喔！</span><br><span class="line">-M  ：强制！不要创建用户家目录！(系统账号默认值)</span><br><span class="line">-m  ：强制！要创建用户家目录！(一般账号默认值)</span><br><span class="line">-c  ：这个就是 /etc/passwd 的第五栏的说明内容啦～可以随便我们配置的啦～</span><br><span class="line">-d  ：指定某个目录成为家目录，而不要使用默认值。务必使用绝对路径！</span><br><span class="line">-r  ：创建一个系统的账号，这个账号的 UID 会有限制 (参考 /etc/login.defs)</span><br><span class="line">-s  ：后面接一个 shell ，若没有指定则默认是 /bin/bash 的啦～</span><br><span class="line">-e  ：后面接一个日期，格式为『YYYY-MM-DD』此项目可写入 shadow 第八字段，</span><br><span class="line">      亦即账号失效日的配置项目啰；</span><br><span class="line">-f  ：后面接 shadow 的第七字段项目，指定口令是否会失效。0为立刻失效，</span><br><span class="line">      -1 为永远不失效(口令只会过期而强制于登陆时重新配置而已。)</span><br><span class="line"></span><br><span class="line">范例一：完全参考默认值创建一个用户，名称为 vbird1</span><br><span class="line">[root@www ~]<span class="comment"># useradd vbird1</span></span><br><span class="line">[root@www ~]<span class="comment"># ll -d /home/vbird1</span></span><br><span class="line">drwx------ 4 vbird1 vbird1 4096 Feb 25 09:38 /home/vbird1</span><br><span class="line"><span class="comment"># 默认会创建用户家目录，且权限为 700 ！这是重点！</span></span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># grep vbird1 /etc/passwd /etc/shadow /etc/group</span></span><br><span class="line">/etc/passwd:vbird1:x:504:505::/home/vbird1:/bin/bash</span><br><span class="line">/etc/shadow:vbird1:!!:14300:0:99999:7:::</span><br><span class="line">/etc/group:vbird1:x:505:    &lt;==默认会创建一个与账号一模一样的群组名</span><br><span class="line"></span><br><span class="line">范例二：假设我已知道我的系统当中有个组名为 users ，且 UID 700 并不存在，</span><br><span class="line">        请用 users 为初始群组，以及 uid 为 700 来创建一个名为 vbird2 的账号</span><br><span class="line">[root@www ~]<span class="comment"># useradd -u 700 -g users vbird2</span></span><br><span class="line">[root@www ~]<span class="comment"># ll -d /home/vbird2</span></span><br><span class="line">drwx------ 4 vbird2 users 4096 Feb 25 09:59 /home/vbird2</span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># grep vbird2 /etc/passwd /etc/shadow /etc/group</span></span><br><span class="line">/etc/passwd:vbird2:x:700:100::/home/vbird2:/bin/bash</span><br><span class="line">/etc/shadow:vbird2:!!:14300:0:99999:7:::</span><br><span class="line"><span class="comment"># 看一下，UID 与 initial group 确实改变成我们需要的了！</span></span><br></pre></td></tr></table></figure>

<p><code>useradd</code>设定了默认值,可以方便的快速创建新用户.调用<code>useradd</code>会对下面👇的系统文件进行变更:</p>
<ul>
<li>在 /etc/passwd 里面创建一行与账号相关的数据，包括创建 UID/GID/家目录等；</li>
<li>在 /etc/shadow 里面将此账号的口令相关参数填入，但是尚未有口令；</li>
<li>在 /etc/group 里面加入一个与账号名称一模一样的组名；</li>
<li>在 /home 底下创建一个与账号同名的目录作为用户家目录，且权限为 700</li>
</ul>
<p>可以通过下面👇的命令查看 <code>useradd</code>的默认值:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># useradd -D</span></span><br><span class="line">GROUP=100		&lt;==默认的群组</span><br><span class="line">HOME=/home		&lt;==默认的家目录所在目录</span><br><span class="line">INACTIVE=-1		&lt;==口令失效日，在 shadow 内的第 7 栏</span><br><span class="line">EXPIRE=			&lt;==账号失效日，在 shadow 内的第 8 栏</span><br><span class="line">SHELL=/bin/bash		&lt;==默认的 shell</span><br><span class="line">SKEL=/etc/skel		&lt;==用户家目录的内容数据参考目录</span><br><span class="line">CREATE_MAIL_SPOOL=yes   &lt;==是否主动帮使用者创建邮件信箱(mailbox)</span><br></pre></td></tr></table></figure>

<p><code>useradd</code>默认值保存在<code>/etc/default/useradd</code>中.</p>
<h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a><a href="%5Bhttp://man.linuxde.net/passwd%5D(http://man.linuxde.net/passwd)">passwd</a></h3><p><code>passwd</code>用来创建和修改用户的口令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># passwd [--stdin]  &lt;==所有人均可使用来改自己的口令</span></span><br><span class="line">[root@www ~]<span class="comment"># passwd [-l] [-u] [--stdin] [-S] \</span></span><br><span class="line">&gt;  [-n 日数] [-x 日数] [-w 日数] [-i 日期] 账号 &lt;==root 功能</span><br><span class="line">选项与参数：</span><br><span class="line">--stdin ：可以透过来自前一个管线的数据，作为口令输入，对 shell script 有帮助！</span><br><span class="line">-l  ：是 Lock 的意思，会将 /etc/shadow 第二栏最前面加上 ! 使口令失效；</span><br><span class="line">-u  ：与 -l 相对，是 Unlock 的意思！</span><br><span class="line">-S  ：列出口令相关参数，亦即 shadow 文件内的大部分信息。</span><br><span class="line">-n  ：后面接天数，shadow 的第 4 字段，多久不可修改口令天数</span><br><span class="line">-x  ：后面接天数，shadow 的第 5 字段，多久内必须要更动口令</span><br><span class="line">-w  ：后面接天数，shadow 的第 6 字段，口令过期前的警告天数</span><br><span class="line">-i  ：后面接『日期』，shadow 的第 7 字段，口令失效日期</span><br><span class="line"></span><br><span class="line">范例一：请 root 给予 vbird2 口令</span><br><span class="line">[root@www ~]<span class="comment"># passwd vbird2</span></span><br><span class="line">Changing password <span class="keyword">for</span> user vbird2.</span><br><span class="line">New UNIX password: &lt;==这里直接输入新的口令，屏幕不会有任何反应</span><br><span class="line">BAD PASSWORD: it is WAY too short &lt;==口令太简单或过短的错误！</span><br><span class="line">Retype new UNIX password:  &lt;==再输入一次同样的口令</span><br><span class="line">passwd: all authentication tokens updated successfully.  &lt;==竟然还是成功修改了！</span><br><span class="line"></span><br><span class="line">范例二：用 vbird2 登陆后，修改 vbird2 自己的口令</span><br><span class="line">[vbird2@www ~]$ passwd   &lt;==后面没有加账号，就是改自己的口令！</span><br><span class="line">Changing password <span class="keyword">for</span> user vbird2.</span><br><span class="line">Changing password <span class="keyword">for</span> vbird2</span><br><span class="line">(current) UNIX password: &lt;==这里输入『原有的旧口令』</span><br><span class="line">New UNIX password: &lt;==这里输入新口令</span><br><span class="line">BAD PASSWORD: it is based on a dictionary word &lt;==口令检验不通过，请再想个新口令</span><br><span class="line">New UNIX password: &lt;==这里再想个来输入吧</span><br><span class="line">Retype new UNIX password: &lt;==通过口令验证！所以重复这个口令的输入</span><br><span class="line">passwd: all authentication tokens updated successfully. &lt;==有无成功看关键词</span><br></pre></td></tr></table></figure>

<p><code>passwd</code>还可以用来锁定账户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># passwd -l vbird2</span></span><br><span class="line">[root@www ~]<span class="comment"># passwd -S vbird2</span></span><br><span class="line">vbird2 LK 2009-02-26 0 60 7 10 (Password locked.)</span><br><span class="line"><span class="comment"># 嘿嘿！状态变成『 LK, Lock 』了啦！无法登陆喔！</span></span><br><span class="line">[root@www ~]<span class="comment"># grep vbird2 /etc/shadow</span></span><br><span class="line">vbird2:!!$1$50MnwNFq<span class="variable">$oChX</span>.0TPanCq7ecE4HYEi.:14301:0:60:7:10::</span><br><span class="line"><span class="comment"># 其实只是在这里加上 !! 而已！</span></span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># passwd -u vbird2</span></span><br><span class="line">[root@www ~]<span class="comment"># grep vbird2 /etc/shadow</span></span><br><span class="line">vbird2:$1$50MnwNFq<span class="variable">$oChX</span>.0TPanCq7ecE4HYEi.:14301:0:60:7:10::</span><br><span class="line"><span class="comment"># 口令字段恢复正常！</span></span><br></pre></td></tr></table></figure>

<p>快速创建一个用户并设置密码的脚本:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adduser &quot;$1&quot;</span><br><span class="line">echo &quot;$2&quot; | passwd &quot;$1&quot; --stdin</span><br></pre></td></tr></table></figure>



<h3 id="chpasswd"><a href="#chpasswd" class="headerlink" title="chpasswd"></a><a href="%5Bhttp://man.linuxde.net/chpasswd%5D(http://man.linuxde.net/chpasswd)">chpasswd</a></h3><p><strong>chpasswd命令</strong>是批量更新用户口令的工具，是把一个文件内容重新定向添加到<code>/etc/shadow</code>中。</p>
<p>先创建用户密码对应文件，格式为<code>username:password</code>，如<code>abc:abc123</code>，必须以这种格式来书写，并且不能有空行，保存成文本文件user.txt，然后执行chpasswd命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chpasswd &lt; user.txt</span><br></pre></td></tr></table></figure>

<h3 id="chage"><a href="#chage" class="headerlink" title="chage"></a><a href="%5Bhttp://man.linuxde.net/chage%5D(http://man.linuxde.net/chage)">chage</a></h3><p><strong>chage命令</strong>是用来修改帐号和密码的有效期限,还可以展示账户口令详细信息.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># chage [-ldEImMW] 账号名</span></span><br><span class="line">选项与参数：</span><br><span class="line">-l ：列出该账号的详细口令参数；</span><br><span class="line">-d ：后面接日期，修改 shadow 第三字段(最近一次更改口令的日期)，格式 YYYY-MM-DD</span><br><span class="line">-E ：后面接日期，修改 shadow 第八字段(账号失效日)，格式 YYYY-MM-DD</span><br><span class="line">-I ：后面接天数，修改 shadow 第七字段(口令失效日期)</span><br><span class="line">-m ：后面接天数，修改 shadow 第四字段(口令最短保留天数)</span><br><span class="line">-M ：后面接天数，修改 shadow 第五字段(口令多久需要进行变更)</span><br><span class="line">-W ：后面接天数，修改 shadow 第六字段(口令过期前警告日期)</span><br><span class="line"></span><br><span class="line">范例一：列出 vbird2 的详细口令参数</span><br><span class="line">[root@www ~]<span class="comment"># chage -l vbird2</span></span><br><span class="line">Last password change                               : Feb 26, 2009</span><br><span class="line">Password expires                                   : Apr 27, 2009</span><br><span class="line">Password inactive                                  : May 07, 2009</span><br><span class="line">Account expires                                    : never</span><br><span class="line">Minimum number of days between password change     : 0</span><br><span class="line">Maximum number of days between password change     : 60</span><br><span class="line">Number of days of warning before password expires  : 7</span><br></pre></td></tr></table></figure>

<p>chage 有一个功能很不错喔！如果你想要让『使用者在第一次登陆时， 强制她们一定要更改口令后才能够使用系统资源』，可以利用如下的方法来处理的！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">范例二：创建一个名为 agetest 的账号，该账号第一次登陆后使用默认口令，</span><br><span class="line">        但必须要更改过口令后，使用新口令才能够登陆系统使用 bash 环境</span><br><span class="line">[root@www ~]<span class="comment"># useradd agetest</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;agetest&quot; | passwd --stdin agetest</span></span><br><span class="line">[root@www ~]<span class="comment"># chage -d 0 agetest</span></span><br><span class="line"><span class="comment"># 此时此账号的口令创建时间会被改为 1970/1/1 ，所以会有问题！</span></span><br><span class="line"></span><br><span class="line">范例三：尝试以 agetest 登陆的情况</span><br><span class="line">You are required to change your password immediately (root enforced)</span><br><span class="line">WARNING: Your password has expired.</span><br><span class="line">You must change your password now and login again!</span><br><span class="line">Changing password <span class="keyword">for</span> user agetest.</span><br><span class="line">Changing password <span class="keyword">for</span> agetest</span><br><span class="line">(current) UNIX password:  &lt;==这个账号被强制要求必须要改口令！</span><br></pre></td></tr></table></figure>

<p>非常有趣吧！你会发现 agetest 这个账号在第一次登陆时可以使用与账号同名的口令登陆， 但登陆时就会被要求立刻更改口令，更改口令完成后就会被踢出系统。再次登陆时就能够使用新口令登陆了！</p>
<h3 id="usermod"><a href="#usermod" class="headerlink" title="usermod"></a><a href="%5Bhttp://man.linuxde.net/usermod%5D(http://man.linuxde.net/usermod)">usermod</a></h3><p><code>usermod</code>用来修改已经存在的用户配置信息:    </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># usermod [-cdegGlsuLU] username</span></span><br><span class="line">选项与参数：</span><br><span class="line">-c  ：后面接账号的说明，即 /etc/passwd 第五栏的说明栏，可以加入一些账号的说明。</span><br><span class="line">-d  ：后面接账号的家目录，即修改 /etc/passwd 的第六栏；</span><br><span class="line">-e  ：后面接日期，格式是 YYYY-MM-DD 也就是在 /etc/shadow 内的第八个字段数据啦！</span><br><span class="line">-f  ：后面接天数，为 shadow 的第七字段。</span><br><span class="line">-g  ：后面接初始群组，修改 /etc/passwd 的第四个字段，亦即是 GID 的字段！</span><br><span class="line">-G  ：后面接次要群组，修改这个使用者能够支持的群组，修改的是 /etc/group 啰～</span><br><span class="line">-a  ：与 -G 合用，可『添加次要群组的支持』而非『配置』喔！</span><br><span class="line">-l  ：后面接账号名称。亦即是修改账号名称， /etc/passwd 的第一栏！</span><br><span class="line">-s  ：后面接 Shell 的实际文件，例如 /bin/bash 或 /bin/csh 等等。</span><br><span class="line">-u  ：后面接 UID 数字啦！即 /etc/passwd 第三栏的数据；</span><br><span class="line">-L  ：暂时将用户的口令冻结，让他无法登陆。其实仅改 /etc/shadow 的口令栏。</span><br><span class="line">-U  ：将 /etc/shadow 口令栏的 ! 拿掉，解冻啦！</span><br><span class="line"></span><br><span class="line">范例一：修改使用者 vbird2 的说明栏，加上『VBird<span class="string">&#x27;s test』的说明。</span></span><br><span class="line"><span class="string">[root@www ~]# usermod -c &quot;VBird&#x27;</span>s <span class="built_in">test</span><span class="string">&quot; vbird2</span></span><br><span class="line"><span class="string">[root@www ~]# grep vbird2 /etc/passwd</span></span><br><span class="line"><span class="string">vbird2:x:700:100:VBird&#x27;s test:/home/vbird2:/bin/bash</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">范例二：用户 vbird2 口令在 2009/12/31 失效。</span></span><br><span class="line"><span class="string">[root@www ~]# usermod -e &quot;</span>2009-12-31<span class="string">&quot; vbird2</span></span><br><span class="line"><span class="string">[root@www ~]# grep vbird2 /etc/shadow</span></span><br><span class="line"><span class="string">vbird2:$1$50MnwNFq<span class="variable">$oChX</span>.0TPanCq7ecE4HYEi.:14301:0:60:7:10:14609:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">范例三：我们创建 vbird3 这个系统账号时并没有给予家目录，请创建他的家目录</span></span><br><span class="line"><span class="string">[root@www ~]# ll -d ~vbird3</span></span><br><span class="line"><span class="string">ls: /home/vbird3: No such file or directory  &lt;==确认一下，确实没有家目录的存在！</span></span><br><span class="line"><span class="string">[root@www ~]# cp -a /etc/skel /home/vbird3</span></span><br><span class="line"><span class="string">[root@www ~]# chown -R vbird3:vbird3 /home/vbird3</span></span><br><span class="line"><span class="string">[root@www ~]# chmod 700 /home/vbird3</span></span><br><span class="line"><span class="string">[root@www ~]# ll -a ~vbird3</span></span><br><span class="line"><span class="string">drwx------  4 vbird3 vbird3 4096 Sep  4 18:15 .  &lt;==用户家目录权限</span></span><br><span class="line"><span class="string">drwxr-xr-x 11 root   root   4096 Feb 26 11:45 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 vbird3 vbird3   33 May 25  2008 .bash_logout</span></span><br><span class="line"><span class="string">-rw-r--r--  1 vbird3 vbird3  176 May 25  2008 .bash_profile</span></span><br><span class="line"><span class="string">-rw-r--r--  1 vbird3 vbird3  124 May 25  2008 .bashrc</span></span><br><span class="line"><span class="string">drwxr-xr-x  3 vbird3 vbird3 4096 Sep  4 18:11 .kde</span></span><br><span class="line"><span class="string">drwxr-xr-x  4 vbird3 vbird3 4096 Sep  4 18:15 .mozilla</span></span><br><span class="line"><span class="string"># 使用 chown -R 是为了连同家目录底下的用户/群组属性都一起变更的意思；</span></span><br><span class="line"><span class="string"># 使用 chmod 没有 -R ，是因为我们仅要修改目录的权限而非内部文件的权限！</span></span><br></pre></td></tr></table></figure>

<h3 id="userdel"><a href="#userdel" class="headerlink" title="userdel"></a><a href="%5Bhttp://man.linuxde.net/userdel%5D(http://man.linuxde.net/userdel)">userdel</a></h3><p><strong>userdel命令</strong>用于删除给定的用户，以及与用户相关的文件。若不加选项，则仅删除用户帐号，而不删除相关文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># userdel [-r] username</span></span><br><span class="line">选项与参数：</span><br><span class="line">-f：强制删除用户，即使用户当前已登录；</span><br><span class="line">-r：连同用户的家目录也一起删除</span><br><span class="line"></span><br><span class="line">范例一：删除 vbird2 ，连同家目录一起删除</span><br><span class="line">[root@www ~]<span class="comment"># userdel -r vbird2</span></span><br></pre></td></tr></table></figure>

<h3 id="finger"><a href="#finger" class="headerlink" title="finger"></a><a href="%5Bhttp://man.linuxde.net/finger%5D(http://man.linuxde.net/finger)">finger</a></h3><p><strong>finger命令</strong>用于查找并显示用户信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@www ~]<span class="comment"># finger [-s] username</span></span><br><span class="line">选项与参数：</span><br><span class="line">-s  ：仅列出用户的账号、全名、终端机代号与登陆时间等等；</span><br><span class="line">-m  ：列出与后面接的账号相同者，而不是利用部分比对 (包括全名部分)</span><br><span class="line"></span><br><span class="line">范例一：观察 vbird1 的用户相关账号属性</span><br><span class="line">[root@www ~]<span class="comment"># finger vbird1</span></span><br><span class="line">Login: vbird1                           Name: (null)</span><br><span class="line">Directory: /home/vbird1                 Shell: /bin/bash</span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">No Plan.</span><br></pre></td></tr></table></figure>

<p>列出的信息说明如下：</p>
<ul>
<li>Login：为使用者账号，亦即 /etc/passwd 内的第一字段；</li>
<li>Name：为全名，亦即 /etc/passwd 内的第五字段(或称为批注)；</li>
<li>Directory：就是家目录了；</li>
<li>Shell：就是使用的 Shell 文件所在；</li>
<li>Never logged in.：figner 还会调查用户登陆主机的情况喔！</li>
<li>No mail.：调查 /var/spool/mail 当中的信箱数据；</li>
<li>No Plan.：调查 ~vbird1/.plan 文件，并将该文件取出来说明！</li>
</ul>
<p>不过是否能够查阅到 Mail 与 Plan 则与权限有关了！因为 Mail / Plan 都是与使用者自己的权限配置有关， root 当然可以查阅到用户的这些信息.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">范例二：利用 vbird1 创建自己的计划档</span><br><span class="line">[vbird1@www ~]$ <span class="built_in">echo</span> <span class="string">&quot;I will study Linux during this year.&quot;</span> &gt; ~/.plan</span><br><span class="line">[vbird1@www ~]$ finger vbird1</span><br><span class="line">Login: vbird1                           Name: (null)</span><br><span class="line">Directory: /home/vbird1                 Shell: /bin/bash</span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">Plan:</span><br><span class="line">I will study Linux during this year.</span><br><span class="line"></span><br><span class="line">范例三：找出目前在系统上面登陆的用户与登陆时间</span><br><span class="line">[vbird1@www ~]$ finger</span><br><span class="line">Login     Name       Tty      Idle  Login Time   Office     Office Phone</span><br><span class="line">root      root       tty1           Feb 26 09:53</span><br><span class="line">vbird1               tty2           Feb 26 15:21</span><br></pre></td></tr></table></figure>

<h3 id="chfn"><a href="#chfn" class="headerlink" title="chfn"></a><a href="%5Bhttp://man.linuxde.net/chfn%5D(http://man.linuxde.net/chfn)">chfn</a></h3><p><strong>chfn命令</strong>用来改变<a target="_blank" rel="noopener" href="http://man.linuxde.net/finger">finger</a>命令显示的信息。这些信息都存放在/etc目录里的<a target="_blank" rel="noopener" href="http://man.linuxde.net/passwd">passwd</a>文件里。若不指定任何选项，则chfn命令会进入问答式界面。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># chfn [-foph] [账号名]</span></span><br><span class="line">选项与参数：</span><br><span class="line">-f  ：后面接完整的大名；</span><br><span class="line">-o  ：您办公室的房间号码；</span><br><span class="line">-p  ：办公室的电话号码；</span><br><span class="line">-h  ：家里的电话号码！</span><br><span class="line"></span><br><span class="line">范例一：vbird1 自己更改一下自己的相关信息！</span><br><span class="line">[vbird1@www ~]$ chfn</span><br><span class="line">Changing finger information <span class="keyword">for</span> vbird1.</span><br><span class="line">Password:                        &lt;==确认身份，所以输入自己的口令</span><br><span class="line">Name []: VBird Tsai <span class="built_in">test</span>         &lt;==输入你想要呈现的全名</span><br><span class="line">Office []: Dic <span class="keyword">in</span> Ksu. Tainan    &lt;==办公室号码</span><br><span class="line">Office Phone []: 06-2727175<span class="comment">#356  &lt;==办公室电话</span></span><br><span class="line">Home Phone []: 06-1234567        &lt;==家里电话号码</span><br><span class="line"></span><br><span class="line">Finger information changed.</span><br><span class="line">[vbird1@www ~]$ grep vbird1 /etc/passwd</span><br><span class="line">vbird1:x:504:505:VBird Tsai <span class="built_in">test</span>,Dic <span class="keyword">in</span> Ksu. Tainan,06-2727175<span class="comment">#356,06-1234567:</span></span><br><span class="line">/home/vbird1:/bin/bash</span><br><span class="line"><span class="comment"># 其实就是改到第五个字段，该字段里面用多个『 , 』分隔就是了！</span></span><br><span class="line"></span><br><span class="line">[vbird1@www ~]$ finger vbird1</span><br><span class="line">Login: vbird1                           Name: VBird Tsai <span class="built_in">test</span></span><br><span class="line">Directory: /home/vbird1                 Shell: /bin/bash</span><br><span class="line">Office: Dic <span class="keyword">in</span> Ksu. Tainan              Office Phone: 06-2727175<span class="comment">#356</span></span><br><span class="line">Home Phone: 06-1234567</span><br><span class="line">On since Thu Feb 26 15:21 (CST) on tty2</span><br><span class="line">No mail.</span><br><span class="line">Plan:</span><br><span class="line">I will study Linux during this year.</span><br><span class="line"><span class="comment"># 就是上面特殊字体呈现的那些地方是由 chfn 所修改出来的！</span></span><br></pre></td></tr></table></figure>

<h3 id="chsh"><a href="#chsh" class="headerlink" title="chsh"></a><a href="%5Bhttp://man.linuxde.net/chsh%5D(http://man.linuxde.net/chsh)">chsh</a></h3><p><strong>chsh命令</strong>用来更换登录系统时使用的shell。若不指定任何参数与用户名称，则chsh会以应答的方式进行设置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[vbird1@www ~]$ chsh [-ls]</span><br><span class="line">选项与参数：</span><br><span class="line">-l  ：列出目前系统上面可用的 shell ，其实就是 /etc/shells 的内容！</span><br><span class="line">-s  ：配置修改自己的 Shell 啰</span><br><span class="line"></span><br><span class="line">范例一：用 vbird1 的身份列出系统上所有合法的 shell，并且指定 csh 为自己的 shell</span><br><span class="line">[vbird1@www ~]$ chsh -l</span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin  &lt;==所谓：合法不可登陆的 Shell 就是这玩意！</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/csh       &lt;==这就是 C shell 啦！</span><br><span class="line">/bin/ksh</span><br><span class="line"><span class="comment"># 其实上面的信息就是我们在 bash 中谈到的 /etc/shells 啦！</span></span><br><span class="line"></span><br><span class="line">[vbird1@www ~]$ chsh -s /bin/csh; grep vbird1 /etc/passwd</span><br><span class="line">Changing shell <span class="keyword">for</span> vbird1.</span><br><span class="line">Password:  &lt;==确认身份，请输入 vbird1 的口令</span><br><span class="line">Shell changed.</span><br><span class="line">vbird1:x:504:505:VBird Tsai <span class="built_in">test</span>,Dic <span class="keyword">in</span> Ksu. Tainan,06-2727175<span class="comment">#356,06-1234567:</span></span><br><span class="line">/home/vbird1:/bin/csh</span><br><span class="line"></span><br><span class="line">[vbird1@www ~]$ chsh -s /bin/bash</span><br><span class="line"><span class="comment"># 测试完毕后，立刻改回来！</span></span><br><span class="line"></span><br><span class="line">[vbird1@www ~]$ ll $(<span class="built_in">which</span> chsh)</span><br><span class="line">-rws--x--x 1 root root 19128 May 25  2008 /usr/bin/chsh</span><br></pre></td></tr></table></figure>

<h3 id="id"><a href="#id" class="headerlink" title="id"></a><a href="%5Bhttp://man.linuxde.net/id%5D(http://man.linuxde.net/id)">id</a></h3><p><strong>id命令</strong>可以显示真实有效的用户ID(UID)和组ID(GID)。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># id [username]</span></span><br><span class="line">-g或--group 　 显示用户所属群组的ID。</span><br><span class="line">-G或--groups   显示用户所属附加群组的ID。</span><br><span class="line">-n或--name 　  显示用户，所属群组或附加群组的名称。</span><br><span class="line">-r或--real 　  显示实际ID。</span><br><span class="line">-u或--user 　  显示用户ID。</span><br><span class="line">-<span class="built_in">help</span> 　       显示帮助。</span><br><span class="line">-version 　    显示版本信息。</span><br><span class="line"></span><br><span class="line">范例一：查阅 root 自己的相关 ID 信息！</span><br><span class="line">[root@www ~]<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),</span><br><span class="line">10(wheel) context=root:system_r:unconfined_t:SystemLow-SystemHigh</span><br><span class="line"><span class="comment"># 上面信息其实是同一行的数据！包括会显示 UID/GID 以及支持的所有群组！</span></span><br><span class="line"><span class="comment"># 至于后面那个 context=... 则是 SELinux 的内容，先不要理会他！</span></span><br><span class="line"></span><br><span class="line">范例二：查阅一下 vbird1 吧～</span><br><span class="line">[root@www ~]<span class="comment"># id vbird1</span></span><br><span class="line">uid=504(vbird1) gid=505(vbird1) groups=505(vbird1) context=root:system_r:</span><br><span class="line">unconfined_t:SystemLow-SystemHigh</span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># id vbird100</span></span><br><span class="line">id: vbird100: No such user  &lt;== id 这个命令也可以用来判断系统上面有无某账号！</span><br></pre></td></tr></table></figure>

<h2 id="群管理"><a href="#群管理" class="headerlink" title="群管理"></a>群管理</h2><h3 id="groupadd"><a href="#groupadd" class="headerlink" title="groupadd"></a><a href="%5Bhttp://man.linuxde.net/groupadd%5D(http://man.linuxde.net/groupadd)">groupadd</a></h3><p><strong>groupadd命令</strong>用于创建一个新的工作组，新工作组的信息将被添加到系统文件中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># groupadd [-g gid] [-r] 组名</span></span><br><span class="line">选项与参数：</span><br><span class="line">-g  ：后面接某个特定的 GID ，用来直接给予某个 GID ～</span><br><span class="line">-r  ：创建系统群组啦！与 /etc/login.defs 内的 GID_MIN 有关。</span><br><span class="line"></span><br><span class="line">范例一：新建一个群组，名称为 group1</span><br><span class="line">[root@www ~]<span class="comment"># groupadd group1</span></span><br><span class="line">[root@www ~]<span class="comment"># grep group1 /etc/group /etc/gshadow</span></span><br><span class="line">/etc/group:group1:x:702:</span><br><span class="line">/etc/gshadow:group1:!::</span><br><span class="line"><span class="comment"># 群组的 GID 也是会由 500 以上最大 GID+1 来决定！</span></span><br></pre></td></tr></table></figure>

<h3 id="groupmod"><a href="#groupmod" class="headerlink" title="groupmod"></a><a href="%5Bhttp://man.linuxde.net/groupmod%5D(http://man.linuxde.net/groupmod)">groupmod</a></h3><p><strong>groupmod命令</strong>更改群组识别码或名称。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># groupmod [-g gid] [-n group_name] 群组名</span></span><br><span class="line">选项与参数：</span><br><span class="line">-g  ：修改既有的 GID 数字；</span><br><span class="line">-n  ：修改既有的组名</span><br><span class="line"></span><br><span class="line">范例一：将刚刚上个命令创建的 group1 名称改为 mygroup ， GID 为 201</span><br><span class="line">[root@www ~]<span class="comment"># groupmod -g 201 -n mygroup group1</span></span><br><span class="line">[root@www ~]<span class="comment"># grep mygroup /etc/group /etc/gshadow</span></span><br><span class="line">/etc/group:mygroup:x:201:</span><br><span class="line">/etc/gshadow:mygroup:!::</span><br></pre></td></tr></table></figure>

<h3 id="groupdel"><a href="#groupdel" class="headerlink" title="groupdel"></a><a href="%5Bhttp://man.linuxde.net/groupdel%5D(http://man.linuxde.net/groupdel)">groupdel</a></h3><p><strong>groupdel命令</strong>用于删除指定的工作组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># groupdel [groupname]</span></span><br><span class="line"></span><br><span class="line">范例一：将刚刚的 mygroup 删除！</span><br><span class="line">[root@www ~]<span class="comment"># groupdel mygroup</span></span><br><span class="line"></span><br><span class="line">范例二：若要删除 vbird1 这个群组的话？</span><br><span class="line">[root@www ~]<span class="comment"># groupdel vbird1</span></span><br><span class="line">groupdel: cannot remove user<span class="string">&#x27;s primary group.</span></span><br></pre></td></tr></table></figure>

<p>为什么 mygroup 可以删除，但是 vbird1 就不能删除呢？原因很简单，『有某个账号 (/etc/passwd) 的 initial group 使用该群组！』 如果查阅一下，你会发现在 /etc/passwd 内的 vbird1 第四栏的 GID 就是 /etc/group 内的 vbird1 那个群组的 GID ，所以啰，当然无法删除～否则 vbird1 这个用户登陆系统后， 就会找不到 GID ，那可是会造成很大的困扰的！</p>
<h3 id="gpasswd"><a href="#gpasswd" class="headerlink" title="gpasswd"></a><a href="%5Bhttp://man.linuxde.net/gpasswd%5D(http://man.linuxde.net/gpasswd)">gpasswd</a></h3><p><code>gpasswd</code>用来管理群组的命令,它可以用来创建群组管理员.并可以将用户加入或移除群组.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关于系统管理员(root)做的动作：</span></span><br><span class="line">[root@www ~]<span class="comment"># gpasswd groupname</span></span><br><span class="line">[root@www ~]<span class="comment"># gpasswd [-A user1,...] [-M user3,...] groupname</span></span><br><span class="line">[root@www ~]<span class="comment"># gpasswd [-rR] groupname</span></span><br><span class="line">选项与参数：</span><br><span class="line">    ：若没有任何参数时，表示给予 groupname 一个口令(/etc/gshadow)</span><br><span class="line">-A  ：将 groupname 的主控权交由后面的使用者管理(该群组的管理员)</span><br><span class="line">-M  ：将某些账号加入这个群组当中！</span><br><span class="line">-r  ：将 groupname 的口令移除</span><br><span class="line">-R  ：让 groupname 的口令栏失效</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关于群组管理员(Group administrator)做的动作：</span></span><br><span class="line">[someone@www ~]$ gpasswd [-ad] user groupname</span><br><span class="line">选项与参数：</span><br><span class="line">-a  ：将某位使用者加入到 groupname 这个群组当中！</span><br><span class="line">-d  ：将某位使用者移除出 groupname 这个群组当中。</span><br><span class="line"></span><br><span class="line">范例一：创建一个新群组，名称为 testgroup 且群组交由 vbird1 管理：</span><br><span class="line">[root@www ~]<span class="comment"># groupadd testgroup  &lt;==先创建群组</span></span><br><span class="line">[root@www ~]<span class="comment"># gpasswd testgroup   &lt;==给这个群组一个口令吧！</span></span><br><span class="line">Changing the password <span class="keyword">for</span> group testgroup</span><br><span class="line">New Password:</span><br><span class="line">Re-enter new password:</span><br><span class="line"><span class="comment"># 输入两次口令就对了！</span></span><br><span class="line">[root@www ~]<span class="comment"># gpasswd -A vbird1 testgroup  &lt;==加入群组管理员为 vbird1</span></span><br><span class="line">[root@www ~]<span class="comment"># grep testgroup /etc/group /etc/gshadow</span></span><br><span class="line">/etc/group:testgroup:x:702:</span><br><span class="line">/etc/gshadow:testgroup:$1<span class="variable">$I5ukIY1</span>.<span class="variable">$o5fmW</span>.cOsc8.K.FHAFLWg0:vbird1:</span><br><span class="line"><span class="comment"># 很有趣吧！此时 vbird1 则拥有 testgroup 的主控权喔！身份有点像板主啦！</span></span><br><span class="line"></span><br><span class="line">范例二：以 vbird1 登陆系统，并且让他加入 vbird1, vbird3 成为 testgroup 成员</span><br><span class="line">[vbird1@www ~]$ id</span><br><span class="line">uid=504(vbird1) gid=505(vbird1) groups=505(vbird1) ....</span><br><span class="line"><span class="comment"># 看得出来，vbird1 尚未加入 testgroup 群组喔！</span></span><br><span class="line"></span><br><span class="line">[vbird1@www ~]$ gpasswd -a vbird1 testgroup</span><br><span class="line">[vbird1@www ~]$ gpasswd -a vbird3 testgroup</span><br><span class="line">[vbird1@www ~]$ grep testgroup /etc/group</span><br><span class="line">testgroup:x:702:vbird1,vbird3</span><br></pre></td></tr></table></figure>

<h2 id="ACL"><a href="#ACL" class="headerlink" title="ACL"></a>ACL</h2><p>ACL 是 Access Control List 的缩写，主要的目的是在提供传统的 owner,group,others 的 read,write,execute 权限之外的细部权限配置。ACL 可以针对单一使用者，单一文件或目录来进行 r,w,x 的权限规范，对于需要特殊权限的使用状况非常有帮助。</p>
<p>那 ACL 主要可以针对哪些方面来控制权限呢？他主要可以针对几个项目：</p>
<ul>
<li>使用者 (user)：可以针对使用者来配置权限；</li>
<li>群组 (group)：针对群组为对象来配置其权限；</li>
<li>默认属性 (mask)：还可以针对在该目录下在创建新文件/目录时，规范新数据的默认权限；</li>
</ul>
<p>由于 ACL 是传统的 Unix-like 操作系统权限的额外支持项目，因此要使用 ACL 必须要有文件系统的支持才行。目前绝大部分的文件系统都有支持 ACL 的功能，包括 ReiserFS, EXT2/EXT3, JFS, XFS 等等。在我们的 CentOS 5.x 当中，默认使用 Ext3 是启动 ACL 支持的！至于察看你的文件系统是否支持 ACL 可以这样看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># mount  &lt;==直接查阅挂载参数的功能</span></span><br><span class="line">/dev/hda2 on / <span class="built_in">type</span> ext3 (rw)</span><br><span class="line">/dev/hda3 on /home <span class="built_in">type</span> ext3 (rw)</span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># dumpe2fs -h /dev/hda2  &lt;==由 superblock 内容去查询</span></span><br><span class="line">....(前面省略)....</span><br><span class="line">Default mount options:    user_xattr acl</span><br><span class="line">....(后面省略)....</span><br></pre></td></tr></table></figure>

<p>由 mount 单纯去查阅不见得可以看到实际的项目，由于目前新的 distributions 常常会主动加入某些默认功能， 如上表所示，其实 CentOS 5.x 在默认的情况下 (Default mount options:) 就帮你加入 acl 的支持了！ 那如果你的系统默认不会帮你加上 acl 的支持呢？那你可以这样做：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># mount -o remount,acl /</span></span><br><span class="line">[root@www ~]<span class="comment"># mount</span></span><br><span class="line">/dev/hda2 on / <span class="built_in">type</span> ext3 (rw,acl)</span><br><span class="line"><span class="comment"># 这样就加入了！但是如果想要每次启动都生效，那就这样做：</span></span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># vi /etc/fstab</span></span><br><span class="line">LABEL=/1   /   ext3    defaults,acl    1 1</span><br></pre></td></tr></table></figure>

<h3 id="setfacl"><a href="#setfacl" class="headerlink" title="setfacl"></a>setfacl</h3><p><code>setfacl</code> 配置某个目录/文件的 ACL 规范</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># setfacl [-bkRd] [&#123;-m|-x&#125; acl参数] 目标文件名</span></span><br><span class="line">选项与参数：</span><br><span class="line">-m ：配置后续的 acl 参数给文件使用，不可与 -x 合用；</span><br><span class="line">-x ：删除后续的 acl 参数，不可与 -m 合用；</span><br><span class="line">-b ：移除所有的 ACL 配置参数；</span><br><span class="line">-k ：移除默认的 ACL 参数，关于所谓的『默认』参数于后续范例中介绍；</span><br><span class="line">-R ：递归配置 acl ，亦即包括次目录都会被配置起来；</span><br><span class="line">-d ：配置『默认 acl 参数』的意思！只对目录有效，在该目录新建的数据会引用此默认值</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 针对特定使用者的方式：</span></span><br><span class="line"><span class="comment"># 配置规范：『 u:[使用者账号列表]:[rwx] 』，例如针对 vbird1 的权限规范 rx ：</span></span><br><span class="line">[root@www ~]<span class="comment"># touch acl_test1</span></span><br><span class="line">[root@www ~]<span class="comment"># ll acl_test1</span></span><br><span class="line">-rw-r--r-- 1 root root 0 Feb 27 13:28 acl_test1</span><br><span class="line">[root@www ~]<span class="comment"># setfacl -m u:vbird1:rx acl_test1</span></span><br><span class="line">[root@www ~]<span class="comment"># ll acl_test1</span></span><br><span class="line">-rw-r-xr--+ 1 root root 0 Feb 27 13:28 acl_test1</span><br><span class="line"><span class="comment"># 权限部分多了个 + ，且与原本的权限 (644) 看起来差异很大！但要如何查阅呢？</span></span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># setfacl -m u::rwx acl_test1</span></span><br><span class="line">[root@www ~]<span class="comment"># ll acl_test1</span></span><br><span class="line">-rwxr-xr--+ 1 root root 0 Feb 27 13:28 acl_test1</span><br><span class="line"><span class="comment"># 无使用者列表，代表配置该文件拥有者，所以上面显示 root 的权限成为 rwx 了！</span></span><br></pre></td></tr></table></figure>

<p>上述动作为最简单的 ACL 配置，利用『 u:使用者:权限 』的方式来配置的啦！配置前请加上 -m 这个选项。 如果一个文件配置了 ACL 参数后，他的权限部分就会多出一个 + 号了！但是此时你看到的权限与实际权限可能就会有点误差！</p>
<h3 id="getfacl"><a href="#getfacl" class="headerlink" title="getfacl"></a>getfacl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># getfacl filename</span></span><br><span class="line">选项与参数：</span><br><span class="line">getfacl 的选项几乎与 setfacl 相同！</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请列出刚刚我们配置的 acl_test1 的权限内容：</span></span><br><span class="line">[root@www ~]<span class="comment"># getfacl acl_test1</span></span><br><span class="line"><span class="comment"># file: acl_test1   &lt;==说明档名而已！</span></span><br><span class="line"><span class="comment"># owner: root       &lt;==说明此文件的拥有者，亦即 ll 看到的第三使用者字段</span></span><br><span class="line"><span class="comment"># group: root       &lt;==此文件的所属群组，亦即 ll 看到的第四群组字段</span></span><br><span class="line">user::rwx           &lt;==使用者列表栏是空的，代表文件拥有者的权限</span><br><span class="line">user:vbird1:r-x     &lt;==针对 vbird1 的权限配置为 rx ，与拥有者并不同！</span><br><span class="line">group::r--          &lt;==针对文件群组的权限配置仅有 r </span><br><span class="line">mask::r-x           &lt;==此文件默认的有效权限 (mask)</span><br><span class="line">other::r--          &lt;==其他人拥有的权限啰！</span><br></pre></td></tr></table></figure>

<p>上面的数据非常容易查阅吧？显示的数据前面加上 # 的，代表这个文件的默认属性，包括文件名、文件拥有者与文件所属群组。 底下出现的 user, group, mask, other 则是属于不同使用者、群组与有效权限(mask)的配置值。 以上面的结果来看，我们刚刚配置的 vbird1 对于这个文件具有 r 与 x 的权限啦！这样看的懂吗？ 如果看的懂的话，接下来让我们在测试其他类型的 setfacl 配置吧！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. 针对特定群组的方式：</span></span><br><span class="line"><span class="comment"># 配置规范：『 g:[群组列表]:[rwx] 』，例如针对 mygroup1 的权限规范 rx ：</span></span><br><span class="line">[root@www ~]<span class="comment"># setfacl -m g:mygroup1:rx acl_test1</span></span><br><span class="line">[root@www ~]<span class="comment"># getfacl acl_test1</span></span><br><span class="line"><span class="comment"># file: acl_test1</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::rwx</span><br><span class="line">user:vbird1:r-x</span><br><span class="line">group::r--</span><br><span class="line">group:mygroup1:r-x  &lt;==这里就是新增的部分！多了这个群组的权限配置！</span><br><span class="line">mask::r-x</span><br><span class="line">other::r--</span><br></pre></td></tr></table></figure>

<p>基本上，群组与使用者的配置并没有什么太大的差异啦！如上表所示，非常容易了解意义。不过，你应该会觉得奇怪的是， 那个 mask 是什么东西啊？其实他有点像是『有效权限』的意思！他的意义是： 使用者或群组所配置的权限必须要存在于 mask 的权限配置范围内才会生效，此即『有效权限 (effective permission)』 我们举个例子来看，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. 针对有效权限 mask 的配置方式：</span></span><br><span class="line"><span class="comment"># 配置规范：『 m:[rwx] 』，例如针对刚刚的文件规范为仅有 r ：</span></span><br><span class="line">[root@www ~]<span class="comment"># setfacl -m m:r acl_test1</span></span><br><span class="line">[root@www ~]<span class="comment"># getfacl acl_test1</span></span><br><span class="line"><span class="comment"># file: acl_test1</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::rwx</span><br><span class="line">user:vbird1:r-x        <span class="comment">#effective:r-- &lt;==vbird1+mask均存在者，仅有 r 而已！</span></span><br><span class="line">group::r--</span><br><span class="line">group:mygroup1:r-x     <span class="comment">#effective:r--</span></span><br><span class="line">mask::r--</span><br><span class="line">other::r--</span><br></pre></td></tr></table></figure>



<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="su"><a href="#su" class="headerlink" title="su"></a><a href="%5Bhttp://man.linuxde.net/su%5D(http://man.linuxde.net/su)">su</a></h3><p><strong>su命令</strong>用于切换当前用户身份到其他用户身份，变更时须输入所要变更的用户帐号与密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># su [-lm] [-c 命令] [username]</span></span><br><span class="line">选项与参数：</span><br><span class="line">-   ：单纯使用 - 如『 su - 』代表使用 login-shell 的变量文件读取方式来登陆系统；</span><br><span class="line">      若使用者名称没有加上去，则代表切换为 root 的身份。</span><br><span class="line">-l  ：与 - 类似，但后面需要加欲切换的使用者账号！也是 login-shell 的方式。</span><br><span class="line">-m  ：-m 与 -p 是一样的，表示『使用目前的环境配置，而不读取新使用者的配置文件』</span><br><span class="line">-c  ：仅进行一次命令，所以 -c 后面可以加上命令喔！</span><br></pre></td></tr></table></figure>

<h3 id="w-who"><a href="#w-who" class="headerlink" title="w/who"></a><a href="%5Bhttp://man.linuxde.net/w%5D(http://man.linuxde.net/w)">w</a>/<a href="%5Bhttp://man.linuxde.net/who%5D(http://man.linuxde.net/who)">who</a></h3><p><code>w</code>和<code>who</code>用来查看当前主机登录的用户.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># w</span></span><br><span class="line"> 13:13:56 up 13:00,  1 user,  load average: 0.08, 0.02, 0.01</span><br><span class="line">USER   TTY    FROM            LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root   pts/1  192.168.1.100   11:04    0.00s  0.36s  0.00s -bash</span><br><span class="line">vbird1 pts/2  192.168.1.100   13:15    0.00s  0.06s  0.02s w</span><br><span class="line"><span class="comment"># 第一行显示目前的时间、启动 (up) 多久，几个用户在系统上平均负载等；</span></span><br><span class="line"><span class="comment"># 第二行只是各个项目的说明，</span></span><br><span class="line"><span class="comment"># 第三行以后，每行代表一个使用者。如上所示，root 登陆并取得终端机名 pts/1 之意。</span></span><br><span class="line"></span><br><span class="line">[root@www ~]<span class="comment"># who</span></span><br><span class="line">root     pts/1        2009-03-04 11:04 (192.168.1.100)</span><br><span class="line">vbird1   pts/2        2009-03-04 13:15 (192.168.1.100)</span><br></pre></td></tr></table></figure>



<h2 id="账户管理例子"><a href="#账户管理例子" class="headerlink" title="账户管理例子"></a>账户管理例子</h2><p>任务一：单纯的完成上头交代的任务，假设我们需要的账号数据如下，你该如何实作？</p>
<table>
<thead>
<tr>
<th>账号名称</th>
<th>账号全名</th>
<th>支持次要群组</th>
<th>是否可登陆主机</th>
<th>口令</th>
</tr>
</thead>
<tbody><tr>
<td>myuser1</td>
<td>1st user</td>
<td>mygroup1</td>
<td>可以</td>
<td>password</td>
</tr>
<tr>
<td>myuser2</td>
<td>2nd user</td>
<td>mygroup1</td>
<td>可以</td>
<td>password</td>
</tr>
<tr>
<td>myuser3</td>
<td>3rd user</td>
<td>无额外支持</td>
<td>不可以</td>
<td>password</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 先处理账号相关属性的数据：</span></span><br><span class="line">[root@www ~]<span class="comment"># groupadd mygroup1</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -G mygroup1 -c &quot;1st user&quot; myuser1</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -G mygroup1 -c &quot;2nd user&quot; myuser2</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -c &quot;3rd user&quot; -s /sbin/nologin myuser3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再处理账号的口令相关属性的数据：</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin myuser1</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin myuser2</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin myuser32</span></span><br></pre></td></tr></table></figure>

<p>任务二：我的使用者 pro1, pro2, pro3 是同一个项目计划的开发人员，我想要让这三个用户在同一个目录底下工作， 但这三个用户还是拥有自己的家目录与基本的私有群组。假设我要让这个项目计划在 /srv/projecta 目录下开发， 可以如何进行？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 假设这三个账号都尚未创建，可先创建一个名为 projecta 的群组，</span></span><br><span class="line"><span class="comment">#    再让这三个用户加入其次要群组的支持即可：</span></span><br><span class="line">[root@www ~]<span class="comment"># groupadd projecta</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -G projecta -c &quot;projecta user&quot; pro1</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -G projecta -c &quot;projecta user&quot; pro2</span></span><br><span class="line">[root@www ~]<span class="comment"># useradd -G projecta -c &quot;projecta user&quot; pro3</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin pro1</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin pro2</span></span><br><span class="line">[root@www ~]<span class="comment"># echo &quot;password&quot; | passwd --stdin pro3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 开始创建此项目的开发目录：</span></span><br><span class="line">[root@www ~]<span class="comment"># mkdir /srv/projecta</span></span><br><span class="line">[root@www ~]<span class="comment"># chgrp projecta /srv/projecta</span></span><br><span class="line">[root@www ~]<span class="comment"># chmod 2770 /srv/projecta</span></span><br><span class="line">[root@www ~]<span class="comment"># ll -d /srv/projecta</span></span><br><span class="line">drwxrws--- 2 root projecta 4096 Feb 27 11:29 /srv/projecta</span><br></pre></td></tr></table></figure>


      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>作者: </span>
      <span>Fynn</span>
    </p>
    <p class="copyright-item">
      <span>来源: </span>
      <a href="https://fynn90.github.io">https://fynn90.github.io</a>
    </p>
    <p class="copyright-item">
      <span>链接: </span>
      <a href="https://fynn90.github.io/2019/05/06/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">https://fynn90.github.io/2019/05/06/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</a>
    </p>

    <p class="copyright-item lincese">
      
      本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
          <div>wechat</div>
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
          <div>alipay</div>
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Linux/">Linux</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2019/05/23/Http%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">HTTP缓存机制</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2019/04/29/Linux%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/">
        <span class="next-text nav-default">Linux的目录结构</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:fynn.90@outlook.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%B8%86-%E9%82%93-17163589/" class="iconfont icon-linkedin" title="linkedin"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://plus.google.com/u/0/117459332873536225443" class="iconfont icon-google" title="google"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://github.com/fatefan" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="http://www.weibo.com/306019091" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/FynnDeng/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  
  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2022

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Fynn</span>
  </span>
  
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=1.1.2"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1.2"></script>

    
  </body>
</html>
