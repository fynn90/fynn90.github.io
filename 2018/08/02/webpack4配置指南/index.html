<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Webpack4配置指南"/>




  <meta name="keywords" content="Webpack," />




  <link rel="alternate" href="/atom.xml" title="Fynn's Blog" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1.2" />



<link rel="canonical" href="https://fynn90.github.io/2018/08/02/webpack4配置指南/"/>


<meta name="description" content="webpack是目前web前端最流行的项目管理工具，它的概念繁多配置繁琐但功能及其强大可以应对各种项目管理需求。 webpack4是webpack一个大的升级，自带一些默认设置项一些之前可以使用的插件也不在兼容。本文记录webpack4下主要会用到的模块和插件。 webpack核心功能是前端Javascript代码的模块管理，而对于css，png等其它类型的文件处理，是通过loader调用第三方">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack4配置指南">
<meta property="og:url" content="https://fynn90.github.io/2018/08/02/webpack4%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="Fynn&#39;s Blog">
<meta property="og:description" content="webpack是目前web前端最流行的项目管理工具，它的概念繁多配置繁琐但功能及其强大可以应对各种项目管理需求。 webpack4是webpack一个大的升级，自带一些默认设置项一些之前可以使用的插件也不在兼容。本文记录webpack4下主要会用到的模块和插件。 webpack核心功能是前端Javascript代码的模块管理，而对于css，png等其它类型的文件处理，是通过loader调用第三方">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://imglf3.nosdn0.126.net/img/Lzg4b1BvbmpvR2dienVwQlpiQklaSGJnZWtZSk1CaTlWdXdmRndXeDgvVFMzaFBlempUc1V3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0">
<meta property="article:published_time" content="2018-08-02T08:30:00.000Z">
<meta property="article:modified_time" content="2019-04-24T02:52:10.784Z">
<meta property="article:author" content="Fynn">
<meta property="article:tag" content="Webpack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://imglf3.nosdn0.126.net/img/Lzg4b1BvbmpvR2dienVwQlpiQklaSGJnZWtZSk1CaTlWdXdmRndXeDgvVFMzaFBlempUc1V3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1.2" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?607980a031d3edcefed502ce80e77ffb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-115728733-1', 'auto');
        ga('send', 'pageview');
  </script>



    <title> Webpack4配置指南 · Fynn's Blog </title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Fynn's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Fynn's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Webpack4配置指南
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018年8月2日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Entry"><span class="toc-text">Entry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output"><span class="toc-text">Output</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#output-filename"><span class="toc-text">output.filename</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#output-chunkFilename"><span class="toc-text">output.chunkFilename</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#output-path"><span class="toc-text">output.path</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#output-publicPath"><span class="toc-text">output.publicPath</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Module"><span class="toc-text">Module</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mode"><span class="toc-text">Mode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimization"><span class="toc-text">Optimization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#optimization-minimize"><span class="toc-text">optimization.minimize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optimization-splitChunks"><span class="toc-text">optimization.splitChunks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Plugins"><span class="toc-text">Plugins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DevServer"><span class="toc-text">DevServer</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p><img src="http://imglf3.nosdn0.126.net/img/Lzg4b1BvbmpvR2dienVwQlpiQklaSGJnZWtZSk1CaTlWdXdmRndXeDgvVFMzaFBlempUc1V3PT0.png?imageView&thumbnail=1680x0&quality=96&stripmeta=0"></p>
<p><a target="_blank" rel="noopener" href="https://webpack.js.org/">webpack</a>是目前web前端最流行的项目管理工具，它的概念繁多配置繁琐但功能及其强大可以应对各种项目管理需求。</p>
<p>webpack4是webpack一个大的升级，自带一些默认设置项一些之前可以使用的插件也不在兼容。本文记录webpack4下主要会用到的模块和插件。</p>
<p>webpack核心功能是前端Javascript代码的模块管理，而对于css，png等其它类型的文件处理，是通过loader调用第三方提供的处理库。webpack4核心模块有:<code>Entry</code>,<code>Output</code>,<code>Module</code>,<code>Optimization</code>,<code>Plugins</code>,<code>Mode</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add -D webpack  webpack-cli</span><br></pre></td></tr></table></figure>
<span id="more"></span>

<h2 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h2><p><code>entry</code>用于配置项目入口文件。它支持的类型有:<code>string | [string] | object &#123; &lt;key&gt;: string | [string] &#125; | (function: () =&gt; string | [string] | object &#123; &lt;key&gt;: string | [string] &#125;) </code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// object模式</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">entry</span>: &#123;</span><br><span class="line">      <span class="attr">home</span>: <span class="string">&quot;./home.js&quot;</span>,</span><br><span class="line">      <span class="attr">about</span>: <span class="string">&quot;./about.js&quot;</span>,</span><br><span class="line">      <span class="attr">contact</span>: <span class="string">&quot;./contact.js&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string模式</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="attr">entry</span>: <span class="string">&#x27;./app.js&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [string]模式</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="attr">entry</span>:[<span class="string">&#x27;./home.js&#x27;</span>,<span class="string">&#x27;./about.js&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// () =&gt;模式</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="attr">entry</span>: <span class="function">() =&gt;</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果传入的是 <code>string</code>，<code>[string]</code>则输出文件名chunk是<code>main</code></p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p><code>output</code>用于配置项目输出信息。你可以设定：输出文件目录，输出文件名，外部资源链接等。</p>
<h3 id="output-filename"><a href="#output-filename" class="headerlink" title="output.filename"></a>output.filename</h3><p>设定输出文件名。可以使用webpack提供的模板：</p>
<table>
<thead>
<tr>
<th>模板</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>[hash]</td>
<td>模块标识的hash值</td>
</tr>
<tr>
<td>[chunkhash]</td>
<td>模块内容的hash值</td>
</tr>
<tr>
<td>[name]</td>
<td>模块名称(根据entry输入类型)</td>
</tr>
<tr>
<td>[id]</td>
<td>模块标识</td>
</tr>
<tr>
<td>[query]</td>
<td>模块的 query，例如，文件名 <code>?</code> 后面的字符串</td>
</tr>
</tbody></table>
<p>[hash]和[chunkhash]可以指定值长度，例如：[hash:16]。默认长度为20。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[id].bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].[hash].bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[chunkhash].bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="output-chunkFilename"><a href="#output-chunkFilename" class="headerlink" title="output.chunkFilename"></a>output.chunkFilename</h3><p>设置为入口文件的输出名，它的配置模板和<code>output.filename</code>一样。默认值是[id].js。</p>
<h3 id="output-path"><a href="#output-path" class="headerlink" title="output.path"></a>output.path</h3><p>指定项目输出路径，必须是绝对路径。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">path</span>: path.resolve(__dirname, <span class="string">&#x27;dist/assets&#x27;</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="output-publicPath"><a href="#output-publicPath" class="headerlink" title="output.publicPath"></a>output.publicPath</h3><p>为项目中所有资源（js,css,img等资源）指定一个基础路径。添加<code>publicPath</code>后静态资源打包后的路径是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">静态资源最终访问路径 = output.publicPath + 资源loader或插件等配置路径</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">output.publicPath = <span class="string">&#x27;/dist/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// image</span></span><br><span class="line"><span class="attr">options</span>: &#123;</span><br><span class="line"> 	<span class="attr">name</span>: <span class="string">&#x27;img/[name].[ext]?[hash]&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最终图片的访问路径为</span></span><br><span class="line">output.publicPath + <span class="string">&#x27;img/[name].[ext]?[hash]&#x27;</span> = <span class="string">&#x27;/dist/img/[name].[ext]?[hash]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// js output.filename</span></span><br><span class="line"><span class="attr">output</span>: &#123;</span><br><span class="line">	<span class="attr">filename</span>: <span class="string">&#x27;[name].js&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最终js的访问路径为</span></span><br><span class="line">output.publicPath + <span class="string">&#x27;[name].js&#x27;</span> = <span class="string">&#x27;/dist/[name].js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// extract-text-webpack-plugin css</span></span><br><span class="line"><span class="keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">	<span class="attr">filename</span>: <span class="string">&#x27;style.[chunkhash].css&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 最终css的访问路径为</span></span><br><span class="line">output.publicPath + <span class="string">&#x27;style.[chunkhash].css&#x27;</span> = <span class="string">&#x27;/dist/style.[chunkhash].css&#x27;</span></span><br></pre></td></tr></table></figure>

<p>一般情况下<strong>publicPath应该以’/‘结尾，而其他loader或插件的配置不要以’/‘开头</strong> </p>
<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><p><code>Module</code>用于指定处理不同类型文件的方式。例如，项目中的css,fonts,png等处理方式需要在该模块指定处理方式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> isProduction = (process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [&#123; <span class="comment">// rules装载需要处理的类型文件</span></span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.tsx?$/</span>, <span class="comment">// 如果文件后缀是 .ts/.tsx结尾的文件，通过 ts-loaser加载器处理</span></span><br><span class="line">        loader: [</span><br><span class="line">          <span class="string">&#x27;ts-loader&#x27;</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">include</span>: path.resolve(<span class="string">&#x27;src&#x27;</span>), <span class="comment">// 指定需要匹配文件所在的文件目录</span></span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> </span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">// 指定处理.css 文件加载器</span></span><br><span class="line">        use: [!isProduction ? <span class="string">&#x27;style-loader&#x27;</span> : MiniCssExtractPlugin.loader,</span><br><span class="line">          <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(eot|svg|ttf|woff|woff2|TTF|otf)(\?\S*)?$/</span>,  <span class="comment">// 指定处理字体 文件加载器 </span></span><br><span class="line">        loader: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[name].[ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?\S*)?$/</span>, <span class="comment">// 指定处理 图片加载器</span></span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">query</span>: &#123;</span><br><span class="line">          <span class="attr">limit</span>: <span class="number">1000</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[name].[ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>针对不同的类型文件webpack生态都有针对的处理加载器可以方便和项目相融合。</p>
<p>加载器的配置是webpack部分最难懂。好在现在主流的前端技术框架 Vue，React都提供了一键式开发环境配置工具<a target="_blank" rel="noopener" href="https://github.com/vuejs/vue-cli"><code>vue-cli</code></a>和<a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app"><code>create-react-app</code></a></p>
<h2 id="Mode"><a href="#Mode" class="headerlink" title="Mode"></a>Mode</h2><p>webpack4提供对项目优化的默认配置，这些配置可以在<code>optimization</code>可以再定制。而<code>optimization</code>中有些配置项的值 是根据<code>mode</code>值而定的。</p>
<p><code>mode</code>是webpack4最新引入的模块，用于告诉webpage打包用以的环境（开发环境或生产环境）。</p>
<p><code>mode</code>可以有三个可选值:<code>production</code>，<code>development </code>,<code>none</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以用命令行只当mode webpack --mode=production</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>操作</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>development</code></td>
<td align="left">将<code>process.env.NODE_ENV</code>在<code>DefinePlugin</code>的值设置为<code>development</code>。并启用<code>NamedChunksPlugin</code>, <code>NamedModulesPlugin </code></td>
</tr>
<tr>
<td><code>production</code></td>
<td align="left">将<code>process.env.NODE_ENV</code>在<code>DefinePlugin</code>的值设置为<code>production</code>。并启用 <code>FlagDependencyUsagePlugin</code>, <code>FlagIncludedChunksPlugin</code>, <code>ModuleConcatenationPlugin</code>, <code>NoEmitOnErrorsPlugin</code>, <code>OccurrenceOrderPlugin</code>, <code>SideEffectsFlagPlugin</code> and <code>UglifyJsPlugin</code>.</td>
</tr>
<tr>
<td><code>none</code></td>
<td align="left">关闭<code>optimization</code>中的所有优化。</td>
</tr>
</tbody></table>
<h2 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a><a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/optimization/">Optimization</a></h2><p>webpack4 提供了根据 <code>mode</code>值针对项目优化的默认配置。而这些配置是在<code>optimization</code>设定的，根据项目可以自定义这些配置。</p>
<h3 id="optimization-minimize"><a href="#optimization-minimize" class="headerlink" title="optimization.minimize"></a>optimization.minimize</h3><p>当<code>mode</code>值为<code>production</code>时，并且<code>optimization.minimize</code>为<code>true</code>。webpack会调用<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/uglifyjs-webpack-plugin/"><code>UglifyjsWebpackPlugin</code></a>压缩文件。</p>
<p>你可以在<code>optimization.minimizer</code>自定义<code>UglifyjsWebpackPlugin</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;uglifyjs-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> UglifyJsPlugin(&#123; <span class="comment">/* your config */</span> &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="optimization-splitChunks"><a href="#optimization-splitChunks" class="headerlink" title="optimization.splitChunks"></a><a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/split-chunks-plugin/">optimization.splitChunks</a></h3><p>webpack4中切分公用模块的配置项。默认配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">splitChunks</span>: &#123;</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;async&#x27;</span>,<span class="comment">// 指定那些模块会被优化 他可以接收三字符串值:all（所有chunk都会被优化）,async(异步加载的chunk被优化),initial(初始的chunk被优化) 。你还可以传递function 指定那些模块被优化或不被优化</span></span><br><span class="line">      <span class="attr">minSize</span>: <span class="number">30000</span>,<span class="comment">// 生产chunk最小字节</span></span><br><span class="line">      <span class="attr">maxSize</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">minChunks</span>: <span class="number">1</span>, <span class="comment">// 分割前被共享的最少次数</span></span><br><span class="line">      <span class="attr">maxAsyncRequests</span>: <span class="number">5</span>,<span class="comment">// 按需加载时的最大并行请求数</span></span><br><span class="line">      <span class="attr">maxInitialRequests</span>: <span class="number">3</span>, <span class="comment">// 项目入口文件最大请求次数</span></span><br><span class="line">      <span class="attr">automaticNameDelimiter</span>: <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="literal">true</span>,<span class="comment">// 切块的名字 ，true 表示自定生产一个名字</span></span><br><span class="line">      <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">        <span class="attr">vendors</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          priority: -<span class="number">10</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">default</span>: &#123;</span><br><span class="line">          <span class="attr">minChunks</span>: <span class="number">2</span>,</span><br><span class="line">          <span class="attr">priority</span>: -<span class="number">20</span>,</span><br><span class="line">          <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a><a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/">Plugins</a></h2><p><code>plugins</code>模块通过第三方插件实现对项目的定制话配置。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> DashboardPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-dashboard/plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> isProduction = (process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">          <span class="attr">filename</span>: !isProduction ? <span class="string">&#x27;[name].css&#x27;</span> : <span class="string">&#x27;[name].[hash].css&#x27;</span>,</span><br><span class="line">          <span class="attr">chunkFilename</span>: !isProduction ? <span class="string">&#x27;[id].css&#x27;</span> : <span class="string">&#x27;[id].[hash].css&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> webpack.optimize.ModuleConcatenationPlugin(),</span><br><span class="line">        <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;</span><br><span class="line">          <span class="attr">minimize</span>: <span class="literal">true</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> DashboardPlugin(),</span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">          <span class="attr">template</span>: path.join(__dirname, <span class="string">&#x27;template.html&#x27;</span>),</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">          <span class="attr">hash</span>: <span class="literal">false</span>,</span><br><span class="line">          <span class="attr">minify</span>: &#123;</span><br><span class="line">            <span class="attr">removeAttributeQuotes</span>: isProduction</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="DevServer"><a href="#DevServer" class="headerlink" title="DevServer"></a><a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/dev-server/">DevServer</a></h2><p>通过<a target="_blank" rel="noopener" href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a>我们可以在webpack中使用<code>devServer</code>模块。该模块可以启动一个node服务器方便我们在开发时及时预览页面效果。</p>
<p>通过<code>webpack-dev-server --mode development --inline --hot --color </code>命令启用<code>devServer</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">     <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">hot</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">historyApiFallback</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">compress</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">open</span>: <span class="literal">true</span>, </span><br><span class="line">        <span class="attr">port</span>: <span class="number">8008</span>,<span class="comment">// node服务器 监听端口</span></span><br><span class="line">        <span class="attr">publicPath</span>: <span class="string">&quot;/&quot;</span>，</span><br><span class="line">        <span class="attr">index</span>: <span class="string">&#x27;index.htm&#x27;</span>， <span class="comment">// 自动打开首页 文件名</span></span><br><span class="line">        <span class="attr">proxy</span>: &#123; <span class="comment">// 将请求接口 代理之后端</span></span><br><span class="line">          <span class="string">&quot;/api&quot;</span>: <span class="string">&quot;http://localhost:3000&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>作者: </span>
      <span>Fynn</span>
    </p>
    <p class="copyright-item">
      <span>来源: </span>
      <a href="https://fynn90.github.io">https://fynn90.github.io</a>
    </p>
    <p class="copyright-item">
      <span>链接: </span>
      <a href="https://fynn90.github.io/2018/08/02/webpack4%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/">https://fynn90.github.io/2018/08/02/webpack4%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/</a>
    </p>

    <p class="copyright-item lincese">
      
      本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
          <div>wechat</div>
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
          <div>alipay</div>
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Webpack/">Webpack</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2018/08/08/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8UIKit%E5%BC%80%E5%8F%91%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">关于使用UIKit开发应用程序</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2018/07/21/Javacript%E4%B8%AD%E7%9A%84%E9%BB%91%E9%AD%94%E6%B3%95/">
        <span class="next-text nav-default">JavaScript中的黑魔法</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:fynn.90@outlook.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%B8%86-%E9%82%93-17163589/" class="iconfont icon-linkedin" title="linkedin"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://plus.google.com/u/0/117459332873536225443" class="iconfont icon-google" title="google"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://github.com/fatefan" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="http://www.weibo.com/306019091" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/FynnDeng/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  
  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2021

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Fynn</span>
  </span>
  
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=1.1.2"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1.2"></script>

    
  </body>
</html>
