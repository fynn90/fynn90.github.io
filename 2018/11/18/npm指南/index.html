<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="NPM指南"/>




  <meta name="keywords" content="npm," />




  <link rel="alternate" href="/atom.xml" title="Fynn's Blog" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1.2" />



<link rel="canonical" href="https://fynn90.github.io/2018/11/18/npm指南/"/>


<meta name="description" content="npm 全称：Node Package Manager (Node 包管理器），目前是Web前端开发重要依赖工具之一。安装Node.js默认会安装npm,前端各种资源都可以通过一个npm命令下载到自己的本地计算机上。 用户通过一个命令将npm上发布的包下载自己本地计算机并在项目中使用，也可以将自己的包发布到npm上供全球Web前端开发者下载使用。 npm的出现极大提升了前端开发体验。">
<meta property="og:type" content="article">
<meta property="og:title" content="NPM指南">
<meta property="og:url" content="https://fynn90.github.io/2018/11/18/npm%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="Fynn&#39;s Blog">
<meta property="og:description" content="npm 全称：Node Package Manager (Node 包管理器），目前是Web前端开发重要依赖工具之一。安装Node.js默认会安装npm,前端各种资源都可以通过一个npm命令下载到自己的本地计算机上。 用户通过一个命令将npm上发布的包下载自己本地计算机并在项目中使用，也可以将自己的包发布到npm上供全球Web前端开发者下载使用。 npm的出现极大提升了前端开发体验。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2018/11/13/5bea6f9a6a5be.png">
<meta property="article:published_time" content="2018-11-18T01:05:00.000Z">
<meta property="article:modified_time" content="2020-11-18T02:51:23.420Z">
<meta property="article:author" content="Fynn">
<meta property="article:tag" content="npm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2018/11/13/5bea6f9a6a5be.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1.2" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?607980a031d3edcefed502ce80e77ffb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-115728733-1', 'auto');
        ga('send', 'pageview');
  </script>



    <title> NPM指南 · Fynn's Blog </title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Fynn's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Fynn's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          NPM指南
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018年11月18日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-%E5%91%BD%E4%BB%A4"><span class="toc-text">npm 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-help"><span class="toc-text">npm help</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-init"><span class="toc-text">npm init</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-install"><span class="toc-text">npm install</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-ci"><span class="toc-text">npm ci</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-update"><span class="toc-text">npm update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-dist-tag"><span class="toc-text">npm dist-tag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-config"><span class="toc-text">npm config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-version"><span class="toc-text">npm version</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json"><span class="toc-text">package.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-outdated"><span class="toc-text">npm outdated</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#name"><span class="toc-text">name</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version"><span class="toc-text">version</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E7%A8%B3%E5%AE%9A%E7%89%88%E6%9C%AC"><span class="toc-text">发布稳定版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E5%8F%91%E5%B8%83%E7%89%88%E6%9C%AC"><span class="toc-text">预发布版本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#description"><span class="toc-text">description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#homepage"><span class="toc-text">homepage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#license"><span class="toc-text">license</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main"><span class="toc-text">main</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dependencies"><span class="toc-text">dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#devDependencies"><span class="toc-text">devDependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#peerDependencies"><span class="toc-text">peerDependencies</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#npm2%E5%92%8Cnpm3%E4%B8%ADpeerDependencies%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">npm2和npm3中peerDependencies的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bundledDependencies"><span class="toc-text">bundledDependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalDependencies"><span class="toc-text">optionalDependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#config"><span class="toc-text">config</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npx"><span class="toc-text">npx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E5%B8%83npm%E5%8C%85"><span class="toc-text">发布npm包</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p><img src="https://i.loli.net/2018/11/13/5bea6f9a6a5be.png" alt="logo"></p>
<p><a target="_blank" rel="noopener" href="https://www.npmjs.com/">npm</a> 全称：Node Package Manager (Node 包管理器），目前是Web前端开发重要依赖工具之一。安装Node.js默认会安装npm,前端各种资源都可以通过一个npm命令下载到自己的本地计算机上。</p>
<p>用户通过一个命令将npm上发布的包下载自己本地计算机并在项目中使用，也可以将自己的包发布到npm上供全球Web前端开发者下载使用。</p>
<p>npm的出现极大提升了前端开发体验。</p>
<span id="more"></span>
<h2 id="npm-命令"><a href="#npm-命令" class="headerlink" title="npm 命令"></a>npm 命令</h2><h3 id="npm-help"><a href="#npm-help" class="headerlink" title="npm help"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/help.html">npm help</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="built_in">help</span> &lt;<span class="built_in">command</span>&gt;</span><br></pre></td></tr></table></figure>

<p>通过该命令可以帮助我们快速查看具体<code>npm</code>命令的用途。</p>
<p><code>npm help -l</code>可以查看所有所有<code>npm</code>命令</p>
<h3 id="npm-init"><a href="#npm-init" class="headerlink" title="npm init"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/init.html">npm init</a></h3><p><code>npm</code>包必须有个 <code>package.json</code>文件，通过<code>npm init</code>可以让自动在目录下创建一个<code>package.json</code>文件，命令行会弹出几个问题用于填充<code>package.json</code>。如果你想快速跳过可以使用<code>npm init -y</code>命令。</p>
<h3 id="npm-install"><a href="#npm-install" class="headerlink" title="npm install"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/install.html">npm install</a></h3><p><code>npm install</code>用于将依赖的包下载到本地<code>node_modules</code>目录中</p>
<p><code>npm install &lt;package name&gt;</code>可以是注册在npm服务上的包，也可以是Github上一个具体项目地址。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ npm install express </span><br><span class="line">$ npm install git@github.com:expressjs/express.git</span><br><span class="line"></span><br><span class="line">npm install (with no args, <span class="keyword">in</span> package dir)</span><br><span class="line">npm install [&lt;@scope&gt;/]&lt;name&gt;</span><br><span class="line">npm install [&lt;@scope&gt;/]&lt;name&gt;@&lt;tag&gt;</span><br><span class="line">npm install [&lt;@scope&gt;/]&lt;name&gt;@&lt;version&gt;</span><br><span class="line">npm install [&lt;@scope&gt;/]&lt;name&gt;@&lt;version range&gt;</span><br><span class="line">npm install &lt;git-host&gt;:&lt;git-user&gt;/&lt;repo-name&gt;</span><br><span class="line">npm install &lt;git repo url&gt;</span><br><span class="line">npm install &lt;tarball file&gt;</span><br><span class="line">npm install &lt;tarball url&gt;</span><br><span class="line">npm install &lt;folder&gt;</span><br></pre></td></tr></table></figure>

<p><code>npm</code>安装的包会记录在<code>package.json</code>文件中。</p>
<p><code>package.json</code>文件有两种记录安装包的方式：生产依赖(<code>dependencies</code>)和开发依赖(<code>devDependencies</code>)。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;^4.0.0&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;^4.0.0&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>npm install &lt;packagename&gt;</code>安装默认是生产依赖，也可以使用<code>npm install -save &lt;packagename&gt;</code>或<code>npm install -S &lt;packagename&gt;</code></p>
<p>开发依赖的安装命令是：<code>npm install -save-dev &lt;packagename&gt;</code>或<code>npm install -D &lt;packagename&gt;</code></p>
<h3 id="npm-ci"><a href="#npm-ci" class="headerlink" title="npm ci"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/ci.html">npm ci</a></h3><p><code>npm ci</code>功能和<code>npm install</code>命令作用一样，它比<code>npm install</code>安装更快，因为它会跳过一些面向用户的操作，它的安装比<code>npm install</code>更严格，它可以帮助捕获由大多数npm用户的增量安装的本地环境引起的错误或不一致。</p>
<p><code>npm ci</code>和<code>npm install</code>区别有：</p>
<ol>
<li>安装前目录必须存在<code>package-lock.json</code>或<code>npm-shrinkwrap.json</code>。</li>
<li>如果<code>package-lock.json</code>包中锁定的包版本和<code>package.json</code>中包版本不一致，则<code>npm ci</code>将提示错误并提示错误。</li>
<li><code>npm ci</code>只能整项目依赖包的安装，不能安装单个依赖包。</li>
<li>如果<code>node_modules</code>目录存在，在<code>npm ci</code>安装前会移除<code>node_modules</code>目录。</li>
<li>它不会对<code>package.json</code>和任何锁定包版本的文件进行操作。</li>
</ol>
<p><code>npm ci</code>一般在自动话环境中使用，例如：测试平台，持续化集成，部署。</p>
<h3 id="npm-update"><a href="#npm-update" class="headerlink" title="npm update"></a><a href="">npm update</a></h3><p><code>npm update</code>用于更新本地依赖包。它会先查询远程服务器最新包的版本，再与本地版本进行比较，如果远程版本更新并符合本地版本安装规，它就将本地依赖包更新到最新版本。</p>
<p><code>npm update</code>更新时，添加参数<code>-S</code>或<code>-D</code>。它会将<code>package.json</code>中的版本号更新。</p>
<h3 id="npm-dist-tag"><a href="#npm-dist-tag" class="headerlink" title="npm dist-tag"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/dist-tag.html">npm dist-tag</a></h3><p><code>npm dist-tag</code>是管理包标签指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm dist-tag add &lt;pkg&gt;@&lt;version&gt; [&lt;tag&gt;]</span><br><span class="line">$ npm dist-tag rm &lt;pkg&gt; &lt;tag&gt;</span><br><span class="line">$ npm dist-tag ls [&lt;pkg&gt;]</span><br></pre></td></tr></table></figure>

<ul>
<li><code>add</code>：使用给指定的包版本设定标签</li>
<li><code>rm</code>：将包中不需要的标签移除</li>
<li><code>ls</code>：将包的所有标签展示出来</li>
</ul>
<p>在安装包时，可以通过设定标签名称下载指定版本的包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install &lt;name&gt;@&lt;tag&gt;</span><br></pre></td></tr></table></figure>

<h3 id="npm-config"><a href="#npm-config" class="headerlink" title="npm config"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/config.html">npm config</a></h3><p><code>npm config</code>命令用于管理<code>npm</code>包管理文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ npm config <span class="built_in">set</span> &lt;key&gt; &lt;value&gt; [-g|--global]</span><br><span class="line">$ npm config get &lt;key&gt;</span><br><span class="line">$ npm config delete &lt;key&gt;</span><br><span class="line">$ npm config list [-l] [--json]</span><br><span class="line">$ npm config edit</span><br><span class="line">$ npm get &lt;key&gt;</span><br><span class="line">$ npm <span class="built_in">set</span> &lt;key&gt; &lt;value&gt; [-g|--global]</span><br></pre></td></tr></table></figure>

<p>用的最多的<code>npm config</code>命令是<code>npm config set registry https://registry.npm.taobao.org</code></p>
<h3 id="npm-version"><a href="#npm-version" class="headerlink" title="npm version"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/version.html">npm version</a></h3><p>你还在手动更新<code>package.json</code>中的版本号嘛？现在一个<code>npm version xxx</code>命令就可以搞定了。它会将你设置的版本号写入<code>package.json</code>文件中。</p>
<p><code>npm</code>包版本号的规则是：重大版本号.功能版本号.修复优化版本号</p>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html">package.json</a></h2><p>每个<code>npm</code>包根目录下都会有一个<code>package.json</code>文件，该文件含有包的所有重要信息，例如：包名，版本号，许可协议等。</p>
<h2 id="npm-outdated"><a href="#npm-outdated" class="headerlink" title="npm outdated"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/outdated.html">npm outdated</a></h2><p>此命令将检查注册表，查看是否有安装的包已过时</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  npm outdated [[&lt;@scope&gt;/]&lt;pkg&gt; ...]</span><br><span class="line">  Package      Current   Wanted   Latest  Location</span><br><span class="line">glob          5.0.15   5.0.15    6.0.1  test-outdated-output</span><br><span class="line">nothingness    0.0.3      git      git  test-outdated-output</span><br><span class="line">npm            3.5.1    3.5.2    3.5.1  test-outdated-output</span><br><span class="line">local-dev      0.0.3   linked   linked  test-outdated-output</span><br><span class="line">once           1.3.2    1.3.3    1.3.3  test-outdated-output</span><br></pre></td></tr></table></figure>

<p>如果不指定pkg，则检查所有过期的包；若指定pkg，则检查指定的pkg。\</p>
<ul>
<li>wanted 显示符合semver规范的最大版本号。若没有多余版本号，则显示当前版本。</li>
<li>latest 显示注册表中被标记为latest的版本。默认情况下latest标记表示最新版本，特殊情况下不是，这取决于开发人员的包管理制度。</li>
<li>location 显示包在依赖关系树中的位置。请注意，npm outdated默认depth为0，仅看到过期包的顶级依赖项。</li>
<li>package 显示包名。若使用了（–long/-l）则还是显示这个包属于dependencies还是devDependency。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm outdated --depth=1 // 显示依赖关系树最大深度,默认是 0</span><br></pre></td></tr></table></figure>

<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p><code>name</code>表示该项目的名称，它的命名规则是限制的：</p>
<ul>
<li>名称长度必须小于214个字节</li>
<li>不能以<code>.</code>和<code>_</code>下划线开头</li>
<li>不能包含大些字母</li>
<li><code>name</code>会成为URL的一部分，所以不能包含非法的URL字符</li>
</ul>
<p><code>npm</code>官方给了一些命名的建议：</p>
<ul>
<li>不要使用和node.js模块相同的名称</li>
<li>名称中主要包含<code>js</code>，<code>node</code>字符串</li>
<li>名称也许会被写入require参数中，所以最好取个简单有意义的名称</li>
<li>创建一个名称前先到<a target="_blank" rel="noopener" href="https://www.npmjs.com/"><a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a></a>查询下该名称是否已经被使用</li>
</ul>
<h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>如果你计划发布你的<code>npm</code>包，你必须要确保在<code>package.json</code>文件中定义了<code>name</code>和<code>version</code>字段。</p>
<p><code>name</code>和<code>package</code>字段是包的唯一性标志，包的区分就是依靠<code>name</code>和<code>package</code>字段。</p>
<p><code>version</code>字段定义当前包的版本号，版本号的命名规则是：重大版本号.功能版本号.修复优化版本号</p>
<h4 id="发布稳定版本"><a href="#发布稳定版本" class="headerlink" title="发布稳定版本"></a>发布稳定版本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新版本号（major | minor | patch | premajor | preminor | prepatch | prerelease）</span></span><br><span class="line"><span class="comment"># 大版本并且不向下兼容时，使用 major</span></span><br><span class="line"><span class="comment"># 有新功能且向下兼容时，使用 minor</span></span><br><span class="line"><span class="comment"># 修复一些问题、优化等，使用 patch</span></span><br><span class="line"><span class="comment"># 下面比如更新一个 patch 小版本号</span></span><br><span class="line">$ npm version patch</span><br><span class="line">$ npm publish</span><br></pre></td></tr></table></figure>

<h4 id="预发布版本"><a href="#预发布版本" class="headerlink" title="预发布版本"></a>预发布版本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 发布一个 prelease 版本，tag=beta</span></span><br><span class="line">$ npm version prerelease</span><br><span class="line">$ npm publish --tag beta</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加预版本号前缀alpha</span></span><br><span class="line">$ npm version prerelease --preid=alpha</span><br><span class="line">v1.0.0-alpha.0</span><br></pre></td></tr></table></figure>

<h3 id="description"><a href="#description" class="headerlink" title="description"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#description-1">description</a></h3><p><code>description</code>字段描述包的一些信息，可以方便用户通过<code>npm search</code>搜索到你的<code>npm</code>包</p>
<h3 id="homepage"><a href="#homepage" class="headerlink" title="homepage"></a>homepage</h3><p><code>homepage</code>字段声明包的主页地址</p>
<h3 id="license"><a href="#license" class="headerlink" title="license"></a>license</h3><p><code>license</code>字段定义你的包使用的许可证，不同的许可证定义了你的包使用范围和用途。<a target="_blank" rel="noopener" href="https://spdx.org/licenses/">https://spdx.org/licenses/</a>可以看到所有许可证和它的详细说明</p>
<h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><p><code>main</code>定义了包入口的文件，通过<code>require()</code>引入你的包时，包管理器会将<code>main</code>中定义的文件引入进去。<code>main</code>默认入口文件名是<code>index.js</code></p>
<h3 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#dependencies">dependencies</a></h3><p><code>dependencies</code>字段用于定义项目运行所依赖的库。它定义为一个对象，<code>key</code>表示包名称，<code>value</code>是包的版本号。</p>
<p>依赖包的版本号定义有四种形式：</p>
<ul>
<li>指定固定的版本：<code>1.2.0</code></li>
<li>波浪号+指定版本号：<code>~1.2.0</code>它表示安装<code>1.2.x</code>最新的版本，不低于<code>1.2.0</code>,但不安装<code>1.3.0</code>。安装时不改变大版本号和次要版本号</li>
<li>插入号+指定版本包： <code>^1.2.0</code>,它表示安装<code>1.x.x</code>最新的版本，不安装<code>2.x.x</code>版本，也就是不改变大版本号。但是如果大版本号是<code>0</code>,则它的意义和波浪号一样，它不改变次版本号。因为大版本号是<code>0</code>说明该包还只是测试简单。</li>
<li><code>latest</code>： 安装最新的版本</li>
</ul>
<h3 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#devdependencies">devDependencies</a></h3><p><code>devDependencies</code>字段定义开发是依赖的包，它表示项目运行时并不依赖的包。</p>
<h3 id="peerDependencies"><a href="#peerDependencies" class="headerlink" title="peerDependencies"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#peerdependencies">peerDependencies</a></h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果你安装我，那么你最好也安装X,Y和Z.</span><br></pre></td></tr></table></figure>

<p>有时候做一些插件开发，比如grunt等工具的插件，它们往往是在grunt的某个版本的基础上开发的，而在他们的代码中并不会出现require(“grunt”)这样的依赖，dependencies配置里边也不会写上grunt的依赖，为了说明此模块只能作为插件跑在宿主的某个版本范围下，可以配置peerDependencies：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;tea-latte&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.3.5&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;tea&quot;</span>: <span class="string">&quot;2.x&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面这个配置确保再npm install的时候tea-latte会和2.x版本的tea一起安装，而且它们两个的依赖关系是同级的：<br>├── <a href="mailto:&#116;&#101;&#x61;&#45;&#108;&#97;&#116;&#116;&#x65;&#64;&#x31;&#x2e;&#x33;&#46;&#53;">&#116;&#101;&#x61;&#45;&#108;&#97;&#116;&#116;&#x65;&#64;&#x31;&#x2e;&#x33;&#46;&#53;</a><br>└── <a href="mailto:&#116;&#x65;&#97;&#64;&#x32;&#46;&#x32;&#46;&#x30;">&#116;&#x65;&#97;&#64;&#x32;&#46;&#x32;&#46;&#x30;</a><br>这个配置的目的是让npm知道，如果要使用此插件模块，请确保在宿主环境按照了我需要的依赖包(<code>peerDependencies中声明的包</code>)。<br>即使宿主环境并没有使用该依赖包,但还是会在它的node_modules中按照该依赖包.</p>
<h4 id="npm2和npm3中peerDependencies的区别"><a href="#npm2和npm3中peerDependencies的区别" class="headerlink" title="npm2和npm3中peerDependencies的区别"></a>npm2和npm3中peerDependencies的区别</h4><p>正如上一节谈论的，在npm2中，PackageA包中peerDependencies所指定的依赖会随着npm install PackageA一起被强制安装，所以不需要在宿主环境的package.json文件中指定对PackageA中peerDependencies内容的依赖。</p>
<p>但是在npm3中，peerDependencies的表现与npm2不同：</p>
<p>npm3中不会再要求peerDependencies所指定的依赖包被强制安装，相反npm3会在安装结束后检查本次安装是否正确，如果不正确会给用户打印警告提示。</p>
<p>就拿上面的例子来说，如果我们npm install PackageA安装PackageA时，你会得到一个警告提示说：</p>
<p><code>PackageB是一个需要的依赖，但是没有被安装。</code><br>这时，你需要手动的在MyProject项目的package.json文件指定PackageB的依赖。</p>
<p>另外，在npm3的项目中，可能存在一个问题就是你所依赖的一个package包更新了它peerDependencies的版本，那么你可能也需要在项目的package.json文件中手动更新到正确的版本。</p>
<h3 id="bundledDependencies"><a href="#bundledDependencies" class="headerlink" title="bundledDependencies"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#bundleddependencies">bundledDependencies</a></h3><p>上面的单词少个d，写成bundleDependencies也可以。<br>指定发布的时候会被一起打包的模块。</p>
<h3 id="optionalDependencies"><a href="#optionalDependencies" class="headerlink" title="optionalDependencies"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#optionaldependencies">optionalDependencies</a></h3><p>如果一个依赖模块可以被使用， 同时你也希望在该模块找不到或无法获取时npm继续运行，你可以把这个模块依赖放到optionalDependencies配置中。这个配置的写法和dependencies的写法一样，不同的是这里边写的模块安装失败不会导致npm install失败。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="built_in">require</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span> fooVersion = <span class="built_in">require</span>(<span class="string">&#x27;foo/package.json&#x27;</span>).version</span><br><span class="line">&#125; <span class="keyword">catch</span> (er) &#123;</span><br><span class="line">  foo = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( notGoodFooVersion(fooVersion) ) &#123;</span><br><span class="line">  foo = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .. then later in your program ..</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (foo) &#123;</span><br><span class="line">  foo.doFooThings()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>optionalDependencies 中的配置会覆盖dependencies中的配置，最好只在一个地方写。</p>
<h3 id="config"><a href="#config" class="headerlink" title="config"></a><a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json.html#config">config</a></h3><p>用来设置一些项目不怎么变化的项目配置，例如port等。<br>用户用的时候可以使用如下用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(...).listen(process.env.npm_package_config_port)</span><br></pre></td></tr></table></figure>

<p>可以通过npm config set foo:port 80来修改config</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">    <span class="attr">&quot;name&quot;</span> : <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;config&quot;</span> : &#123; <span class="attr">&quot;port&quot;</span> : <span class="string">&quot;8080&quot;</span> &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="npx"><a href="#npx" class="headerlink" title="npx"></a><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/npx">npx</a></h2><p><code>npx</code>用于执行<code>npm</code>包的二进制脚本。</p>
<p><code>npx &lt;command&gt;</code>它会查找<code>node_modules/.bin</code>目录对于的可执行二进制脚本。如果本地没有对于的可执行二进制脚本，它会去全局查找。如果全局也没有，它就会从远程仓库下载对应的<code>npm</code>包。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D webpack</span><br><span class="line">$ npx webpack -v</span><br></pre></td></tr></table></figure>

<p><code>npm</code>5.2.0版本之后会默认安装<code>npx</code>包。</p>
<p>有了<code>npx</code>,对于需要执行的<code>npm</code>包二进制命令，你不用将它写进<code>scripts</code>或进行全局安装。</p>
<h2 id="发布npm包"><a href="#发布npm包" class="headerlink" title="发布npm包"></a>发布npm包</h2><p>将包发布到<code>npm</code>远程仓库非常简单，只需要三个步骤（确保你的包准备好了）。</p>
<ol>
<li><code>npm adduser</code>注册一个npmjs.com的账号</li>
<li><code>npm login</code>登录已有的账号</li>
<li><code>npm publish</code>发布包（在包的根目录执行）</li>
</ol>
<p><strong>注意：</strong> 在发布前，你应该登录<a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com</a> 看下自己的包名是否已经存在。</p>
<p>​        如果你的<code>registry</code>指向其它镜像，你需要将它设定为<code>https://registry.npmjs.com/</code></p>
<p>一个完整的<code>npm</code>包，应该包括：</p>
<ul>
<li><code>package.json</code>文件</li>
<li><code>README.md</code>文件，说明包的用途和使用方式</li>
<li><code>index.js</code>文件，包的入口文件</li>
<li><code>tests</code>目录，单元测试文件目录</li>
</ul>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>作者: </span>
      <span>Fynn</span>
    </p>
    <p class="copyright-item">
      <span>来源: </span>
      <a href="https://fynn90.github.io">https://fynn90.github.io</a>
    </p>
    <p class="copyright-item">
      <span>链接: </span>
      <a href="https://fynn90.github.io/2018/11/18/npm%E6%8C%87%E5%8D%97/">https://fynn90.github.io/2018/11/18/npm%E6%8C%87%E5%8D%97/</a>
    </p>

    <p class="copyright-item lincese">
      
      本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.png" title="wechat">
          <div>wechat</div>
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.png" title="alipay">
          <div>alipay</div>
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/npm/">npm</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2018/11/21/npm%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">搭建NPM私有仓库</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2018/11/14/Canvas%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/">
        <span class="next-text nav-default">Canvas文本和图片处理</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:fynn.90@outlook.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%B8%86-%E9%82%93-17163589/" class="iconfont icon-linkedin" title="linkedin"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://plus.google.com/u/0/117459332873536225443" class="iconfont icon-google" title="google"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://github.com/fatefan" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="http://www.weibo.com/306019091" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/FynnDeng/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  
  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2021

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Fynn</span>
  </span>
  
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=1.1.2"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1.2"></script>

    
  </body>
</html>
